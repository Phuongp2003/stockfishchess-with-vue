(function(I,b){typeof exports=="object"&&typeof module<"u"?b(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],b):(I=typeof globalThis<"u"?globalThis:I||self,b(I.Chess={},I.Vue))})(this,function(I,b){"use strict";var Xi=Object.defineProperty;var Zi=(I,b,be)=>b in I?Xi(I,b,{enumerable:!0,configurable:!0,writable:!0,value:be}):I[b]=be;var O=(I,b,be)=>Zi(I,typeof b!="symbol"?b+"":b,be);const be={class:"promotion-dialog",open:""},mn=["aria-label","onClick","onTouchstartPassive"],gn=b.defineComponent({__name:"PromotionDialog",props:{state:{}},emits:["promotionSelected"],setup(e,{emit:t}){const o=e,n=[{name:"Queen",data:"q"},{name:"Knight",data:"n"},{name:"Rook",data:"r"},{name:"Bishop",data:"b"}];function r(s){var i,a;(a=(i=o.state).callback)==null||a.call(i,s.data),t("promotionSelected")}return(s,i)=>(b.openBlock(),b.createElementBlock("dialog",be,[(b.openBlock(),b.createElementBlock(b.Fragment,null,b.renderList(n,a=>b.createElementVNode("button",{key:a.name,type:"button",class:b.normalizeClass([a.name.toLowerCase(),s.state.color]),"aria-label":a.name,onClick:c=>r(a),onTouchstartPassive:c=>r(a)},null,42,mn)),64))]))}});/**
 * @license
 * Copyright (c) 2023, Jeff Hlywa (jhlywa@gmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */const L="w",W="b",N="p",Xe="n",Ne="b",ve="r",te="q",x="k",Ze="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",V=-1,bn={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},yn=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"],_={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},S={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Ye={b:[16,32,17,15],w:[-16,-32,-17,-15]},Lt={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},wn=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],vn=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],_n={p:1,n:2,b:4,r:8,q:16,k:32},Sn="pnbrqkPNBRQK",It=[Xe,Ne,ve,te],En=7,kn=6,Cn=1,Tn=0,xe={[x]:_.KSIDE_CASTLE,[te]:_.QSIDE_CASTLE},oe={w:[{square:S.a1,flag:_.QSIDE_CASTLE},{square:S.h1,flag:_.KSIDE_CASTLE}],b:[{square:S.a8,flag:_.QSIDE_CASTLE},{square:S.h8,flag:_.KSIDE_CASTLE}]},Pn={b:Cn,w:kn},An=["1-0","0-1","1/2-1/2","*"];function le(e){return e>>4}function _e(e){return e&15}function Dt(e){return"0123456789".indexOf(e)!==-1}function H(e){const t=_e(e),o=le(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(o,o+1)}function Se(e){return e===L?W:L}function Rn(e){const t=e.split(/\s+/);if(t.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const o=parseInt(t[5],10);if(isNaN(o)||o<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const n=parseInt(t[4],10);if(isNaN(n)||n<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const r=t[0].split("/");if(r.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let i=0;i<r.length;i++){let a=0,c=!1;for(let l=0;l<r[i].length;l++)if(Dt(r[i][l])){if(c)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};a+=parseInt(r[i][l],10),c=!0}else{if(!/^[prnbqkPRNBQK]$/.test(r[i][l]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};a+=1,c=!1}if(a!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(t[3][1]=="3"&&t[1]=="w"||t[3][1]=="6"&&t[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const s=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:i,regex:a}of s){if(!a.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${i} king`};if((t[0].match(a)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${i} kings`}}return{ok:!0}}function On(e,t){const o=e.from,n=e.to,r=e.piece;let s=0,i=0,a=0;for(let c=0,l=t.length;c<l;c++){const d=t[c].from,f=t[c].to,p=t[c].piece;r===p&&o!==d&&n===f&&(s++,le(o)===le(d)&&i++,_e(o)===_e(d)&&a++)}return s>0?i>0&&a>0?H(o):a>0?H(o).charAt(1):H(o).charAt(0):""}function ne(e,t,o,n,r,s=void 0,i=_.NORMAL){const a=le(n);if(r===N&&(a===En||a===Tn))for(let c=0;c<It.length;c++){const l=It[c];e.push({color:t,from:o,to:n,piece:r,captured:s,promotion:l,flags:i|_.PROMOTION})}else e.push({color:t,from:o,to:n,piece:r,captured:s,flags:i})}function qt(e){let t=e.charAt(0);return t>="a"&&t<="h"?e.match(/[a-h]\d.*[a-h]\d/)?void 0:N:(t=t.toLowerCase(),t==="o"?x:t)}function et(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class Mn{constructor(t=Ze){O(this,"_board",new Array(128));O(this,"_turn",L);O(this,"_header",{});O(this,"_kings",{w:V,b:V});O(this,"_epSquare",-1);O(this,"_halfMoves",0);O(this,"_moveNumber",0);O(this,"_history",[]);O(this,"_comments",{});O(this,"_castling",{w:0,b:0});this.load(t)}clear(t=!1){this._board=new Array(128),this._kings={w:V,b:V},this._turn=L,this._castling={w:0,b:0},this._epSquare=V,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=t?this._header:{},this._updateSetup(this.fen())}removeHeader(t){t in this._header&&delete this._header[t]}load(t,o=!1){let n=t.split(/\s+/);if(n.length>=2&&n.length<6){const c=["-","-","0","1"];t=n.concat(c.slice(-(6-n.length))).join(" ")}n=t.split(/\s+/);const{ok:r,error:s}=Rn(t);if(!r)throw new Error(s);const i=n[0];let a=0;this.clear(o);for(let c=0;c<i.length;c++){const l=i.charAt(c);if(l==="/")a+=8;else if(Dt(l))a+=parseInt(l,10);else{const d=l<"a"?L:W;this.put({type:l.toLowerCase(),color:d},H(a)),a++}}this._turn=n[1],n[2].indexOf("K")>-1&&(this._castling.w|=_.KSIDE_CASTLE),n[2].indexOf("Q")>-1&&(this._castling.w|=_.QSIDE_CASTLE),n[2].indexOf("k")>-1&&(this._castling.b|=_.KSIDE_CASTLE),n[2].indexOf("q")>-1&&(this._castling.b|=_.QSIDE_CASTLE),this._epSquare=n[3]==="-"?V:S[n[3]],this._halfMoves=parseInt(n[4],10),this._moveNumber=parseInt(n[5],10),this._updateSetup(this.fen())}fen(){var s,i;let t=0,o="";for(let a=S.a8;a<=S.h1;a++){if(this._board[a]){t>0&&(o+=t,t=0);const{color:c,type:l}=this._board[a];o+=c===L?l.toUpperCase():l.toLowerCase()}else t++;a+1&136&&(t>0&&(o+=t),a!==S.h1&&(o+="/"),t=0,a+=8)}let n="";this._castling[L]&_.KSIDE_CASTLE&&(n+="K"),this._castling[L]&_.QSIDE_CASTLE&&(n+="Q"),this._castling[W]&_.KSIDE_CASTLE&&(n+="k"),this._castling[W]&_.QSIDE_CASTLE&&(n+="q"),n=n||"-";let r="-";if(this._epSquare!==V){const a=this._epSquare+(this._turn===L?16:-16),c=[a+1,a-1];for(const l of c){if(l&136)continue;const d=this._turn;if(((s=this._board[l])==null?void 0:s.color)===d&&((i=this._board[l])==null?void 0:i.type)===N){this._makeMove({color:d,from:l,to:this._epSquare,piece:N,captured:N,flags:_.EP_CAPTURE});const f=!this._isKingAttacked(d);if(this._undoMove(),f){r=H(this._epSquare);break}}}}return[o,this._turn,n,r,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(t){this._history.length>0||(t!==Ze?(this._header.SetUp="1",this._header.FEN=t):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(Ze)}get(t){return this._board[S[t]]||!1}put({type:t,color:o},n){if(Sn.indexOf(t.toLowerCase())===-1||!(n in S))return!1;const r=S[n];return t==x&&!(this._kings[o]==V||this._kings[o]==r)?!1:(this._board[r]={type:t,color:o},t===x&&(this._kings[o]=r),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0)}remove(t){const o=this.get(t);return delete this._board[S[t]],o&&o.type===x&&(this._kings[o.color]=V),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),o}_updateCastlingRights(){var n,r,s,i,a,c,l,d,f,p,w,u;const t=((n=this._board[S.e1])==null?void 0:n.type)===x&&((r=this._board[S.e1])==null?void 0:r.color)===L,o=((s=this._board[S.e8])==null?void 0:s.type)===x&&((i=this._board[S.e8])==null?void 0:i.color)===W;(!t||((a=this._board[S.a1])==null?void 0:a.type)!==ve||((c=this._board[S.a1])==null?void 0:c.color)!==L)&&(this._castling.w&=~_.QSIDE_CASTLE),(!t||((l=this._board[S.h1])==null?void 0:l.type)!==ve||((d=this._board[S.h1])==null?void 0:d.color)!==L)&&(this._castling.w&=~_.KSIDE_CASTLE),(!o||((f=this._board[S.a8])==null?void 0:f.type)!==ve||((p=this._board[S.a8])==null?void 0:p.color)!==W)&&(this._castling.b&=~_.QSIDE_CASTLE),(!o||((w=this._board[S.h8])==null?void 0:w.type)!==ve||((u=this._board[S.h8])==null?void 0:u.color)!==W)&&(this._castling.b&=~_.KSIDE_CASTLE)}_updateEnPassantSquare(){var s,i;if(this._epSquare===V)return;const t=this._epSquare+(this._turn===L?-16:16),o=this._epSquare+(this._turn===L?16:-16),n=[o+1,o-1];if(this._board[t]!==null||this._board[this._epSquare]!==null||((s=this._board[o])==null?void 0:s.color)!==Se(this._turn)||((i=this._board[o])==null?void 0:i.type)!==N){this._epSquare=V;return}const r=a=>{var c,l;return!(a&136)&&((c=this._board[a])==null?void 0:c.color)===this._turn&&((l=this._board[a])==null?void 0:l.type)===N};n.some(r)||(this._epSquare=V)}_attacked(t,o){for(let n=S.a8;n<=S.h1;n++){if(n&136){n+=7;continue}if(this._board[n]===void 0||this._board[n].color!==t)continue;const r=this._board[n],s=n-o;if(s===0)continue;const i=s+119;if(wn[i]&_n[r.type]){if(r.type===N){if(s>0){if(r.color===L)return!0}else if(r.color===W)return!0;continue}if(r.type==="n"||r.type==="k")return!0;const a=vn[i];let c=n+a,l=!1;for(;c!==o;){if(this._board[c]!=null){l=!0;break}c+=a}if(!l)return!0}}return!1}_isKingAttacked(t){const o=this._kings[t];return o===-1?!1:this._attacked(Se(t),o)}isAttacked(t,o){return this._attacked(o,S[t])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const t={b:0,n:0,r:0,q:0,k:0,p:0},o=[];let n=0,r=0;for(let s=S.a8;s<=S.h1;s++){if(r=(r+1)%2,s&136){s+=7;continue}const i=this._board[s];i&&(t[i.type]=i.type in t?t[i.type]+1:1,i.type===Ne&&o.push(r),n++)}if(n===2||n===3&&(t[Ne]===1||t[Xe]===1))return!0;if(n===t[Ne]+2){let s=0;const i=o.length;for(let a=0;a<i;a++)s+=o[a];if(s===0||s===i)return!0}return!1}isThreefoldRepetition(){const t=[],o={};let n=!1;for(;;){const r=this._undoMove();if(!r)break;t.push(r)}for(;;){const r=this.fen().split(" ").slice(0,4).join(" ");o[r]=r in o?o[r]+1:1,o[r]>=3&&(n=!0);const s=t.pop();if(s)this._makeMove(s);else break}return n}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:t=!1,square:o=void 0,piece:n=void 0}={}){const r=this._moves({square:o,piece:n});return t?r.map(s=>this._makePretty(s)):r.map(s=>this._moveToSan(s,r))}_moves({legal:t=!0,piece:o=void 0,square:n=void 0}={}){var w;const r=n?n.toLowerCase():void 0,s=o==null?void 0:o.toLowerCase(),i=[],a=this._turn,c=Se(a);let l=S.a8,d=S.h1,f=!1;if(r)if(r in S)l=d=S[r],f=!0;else return[];for(let u=l;u<=d;u++){if(u&136){u+=7;continue}if(!this._board[u]||this._board[u].color===c)continue;const{type:m}=this._board[u];let g;if(m===N){if(s&&s!==m)continue;g=u+Ye[a][0],this._board[g]||(ne(i,a,u,g,N),g=u+Ye[a][1],Pn[a]===le(u)&&!this._board[g]&&ne(i,a,u,g,N,void 0,_.BIG_PAWN));for(let v=2;v<4;v++)g=u+Ye[a][v],!(g&136)&&(((w=this._board[g])==null?void 0:w.color)===c?ne(i,a,u,g,N,this._board[g].type,_.CAPTURE):g===this._epSquare&&ne(i,a,u,g,N,N,_.EP_CAPTURE))}else{if(s&&s!==m)continue;for(let v=0,y=Lt[m].length;v<y;v++){const k=Lt[m][v];for(g=u;g+=k,!(g&136);){if(!this._board[g])ne(i,a,u,g,m);else{if(this._board[g].color===a)break;ne(i,a,u,g,m,this._board[g].type,_.CAPTURE);break}if(m===Xe||m===x)break}}}}if((s===void 0||s===x)&&(!f||d===this._kings[a])){if(this._castling[a]&_.KSIDE_CASTLE){const u=this._kings[a],m=u+2;!this._board[u+1]&&!this._board[m]&&!this._attacked(c,this._kings[a])&&!this._attacked(c,u+1)&&!this._attacked(c,m)&&ne(i,a,this._kings[a],m,x,void 0,_.KSIDE_CASTLE)}if(this._castling[a]&_.QSIDE_CASTLE){const u=this._kings[a],m=u-2;!this._board[u-1]&&!this._board[u-2]&&!this._board[u-3]&&!this._attacked(c,this._kings[a])&&!this._attacked(c,u-1)&&!this._attacked(c,m)&&ne(i,a,this._kings[a],m,x,void 0,_.QSIDE_CASTLE)}}if(!t||this._kings[a]===-1)return i;const p=[];for(let u=0,m=i.length;u<m;u++)this._makeMove(i[u]),this._isKingAttacked(a)||p.push(i[u]),this._undoMove();return p}move(t,{strict:o=!1}={}){let n=null;if(typeof t=="string")n=this._moveFromSan(t,o);else if(typeof t=="object"){const s=this._moves();for(let i=0,a=s.length;i<a;i++)if(t.from===H(s[i].from)&&t.to===H(s[i].to)&&(!("promotion"in s[i])||t.promotion===s[i].promotion)){n=s[i];break}}if(!n)throw typeof t=="string"?new Error(`Invalid move: ${t}`):new Error(`Invalid move: ${JSON.stringify(t)}`);const r=this._makePretty(n);return this._makeMove(n),r}_push(t){this._history.push({move:t,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(t){const o=this._turn,n=Se(o);if(this._push(t),this._board[t.to]=this._board[t.from],delete this._board[t.from],t.flags&_.EP_CAPTURE&&(this._turn===W?delete this._board[t.to-16]:delete this._board[t.to+16]),t.promotion&&(this._board[t.to]={type:t.promotion,color:o}),this._board[t.to].type===x){if(this._kings[o]=t.to,t.flags&_.KSIDE_CASTLE){const r=t.to-1,s=t.to+1;this._board[r]=this._board[s],delete this._board[s]}else if(t.flags&_.QSIDE_CASTLE){const r=t.to+1,s=t.to-2;this._board[r]=this._board[s],delete this._board[s]}this._castling[o]=0}if(this._castling[o]){for(let r=0,s=oe[o].length;r<s;r++)if(t.from===oe[o][r].square&&this._castling[o]&oe[o][r].flag){this._castling[o]^=oe[o][r].flag;break}}if(this._castling[n]){for(let r=0,s=oe[n].length;r<s;r++)if(t.to===oe[n][r].square&&this._castling[n]&oe[n][r].flag){this._castling[n]^=oe[n][r].flag;break}}t.flags&_.BIG_PAWN?o===W?this._epSquare=t.to-16:this._epSquare=t.to+16:this._epSquare=V,t.piece===N?this._halfMoves=0:t.flags&(_.CAPTURE|_.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,o===W&&this._moveNumber++,this._turn=n}undo(){const t=this._undoMove();return t?this._makePretty(t):null}_undoMove(){const t=this._history.pop();if(t===void 0)return null;const o=t.move;this._kings=t.kings,this._turn=t.turn,this._castling=t.castling,this._epSquare=t.epSquare,this._halfMoves=t.halfMoves,this._moveNumber=t.moveNumber;const n=this._turn,r=Se(n);if(this._board[o.from]=this._board[o.to],this._board[o.from].type=o.piece,delete this._board[o.to],o.captured)if(o.flags&_.EP_CAPTURE){let s;n===W?s=o.to-16:s=o.to+16,this._board[s]={type:N,color:r}}else this._board[o.to]={type:o.captured,color:r};if(o.flags&(_.KSIDE_CASTLE|_.QSIDE_CASTLE)){let s,i;o.flags&_.KSIDE_CASTLE?(s=o.to+1,i=o.to-1):(s=o.to-2,i=o.to+1),this._board[s]=this._board[i],delete this._board[i]}return o}pgn({newline:t=`
`,maxWidth:o=0}={}){const n=[];let r=!1;for(const p in this._header)n.push("["+p+' "'+this._header[p]+'"]'+t),r=!0;r&&this._history.length&&n.push(t);const s=p=>{const w=this._comments[this.fen()];if(typeof w<"u"){const u=p.length>0?" ":"";p=`${p}${u}{${w}}`}return p},i=[];for(;this._history.length>0;)i.push(this._undoMove());const a=[];let c="";for(i.length===0&&a.push(s(""));i.length>0;){c=s(c);const p=i.pop();if(!p)break;if(!this._history.length&&p.color==="b"){const w=`${this._moveNumber}. ...`;c=c?`${c} ${w}`:w}else p.color==="w"&&(c.length&&a.push(c),c=this._moveNumber+".");c=c+" "+this._moveToSan(p,this._moves({legal:!0})),this._makeMove(p)}if(c.length&&a.push(s(c)),typeof this._header.Result<"u"&&a.push(this._header.Result),o===0)return n.join("")+a.join(" ");const l=function(){return n.length>0&&n[n.length-1]===" "?(n.pop(),!0):!1},d=function(p,w){for(const u of w.split(" "))if(u){if(p+u.length>o){for(;l();)p--;n.push(t),p=0}n.push(u),p+=u.length,n.push(" "),p++}return l()&&p--,p};let f=0;for(let p=0;p<a.length;p++){if(f+a[p].length>o&&a[p].includes("{")){f=d(f,a[p]);continue}f+a[p].length>o&&p!==0?(n[n.length-1]===" "&&n.pop(),n.push(t),f=0):p!==0&&(n.push(" "),f++),n.push(a[p]),f+=a[p].length}return n.join("")}header(...t){for(let o=0;o<t.length;o+=2)typeof t[o]=="string"&&typeof t[o+1]=="string"&&(this._header[t[o]]=t[o+1]);return this._header}loadPgn(t,{strict:o=!1,newlineChar:n=`\r?
`}={}){function r(y){return y.replace(/\\/g,"\\")}function s(y){const k={},A=y.split(new RegExp(r(n)));let T="",q="";for(let B=0;B<A.length;B++){const C=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;T=A[B].replace(C,"$1"),q=A[B].replace(C,"$2"),T.trim().length>0&&(k[T]=q)}return k}t=t.trim();const i=new RegExp("^(\\[((?:"+r(n)+")|.)*\\])((?:\\s*"+r(n)+"){2}|(?:\\s*"+r(n)+")*$)").exec(t),a=i&&i.length>=2?i[1]:"";this.reset();const c=s(a);let l="";for(const y in c)y.toLowerCase()==="fen"&&(l=c[y]),this.header(y,c[y]);if(!o)l&&this.load(l,!0);else if(c.SetUp==="1"){if(!("FEN"in c))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(c.FEN,!0)}function d(y){return Array.from(y).map(function(k){return k.charCodeAt(0)<128?k.charCodeAt(0).toString(16):encodeURIComponent(k).replace(/%/g,"").toLowerCase()}).join("")}function f(y){return y.length==0?"":decodeURIComponent("%"+(y.match(/.{1,2}/g)||[]).join("%"))}const p=function(y){return y=y.replace(new RegExp(r(n),"g")," "),`{${d(y.slice(1,y.length-1))}}`},w=function(y){if(y.startsWith("{")&&y.endsWith("}"))return f(y.slice(1,y.length-1))};let u=t.replace(a,"").replace(new RegExp(`({[^}]*})+?|;([^${r(n)}]*)`,"g"),function(y,k,A){return k!==void 0?p(k):" "+p(`{${A.slice(1)}}`)}).replace(new RegExp(r(n),"g")," ");const m=/(\([^()]+\))+?/g;for(;m.test(u);)u=u.replace(m,"");u=u.replace(/\d+\.(\.\.)?/g,""),u=u.replace(/\.\.\./g,""),u=u.replace(/\$\d+/g,"");let g=u.trim().split(new RegExp(/\s+/));g=g.filter(y=>y!=="");let v="";for(let y=0;y<g.length;y++){const k=w(g[y]);if(k!==void 0){this._comments[this.fen()]=k;continue}const A=this._moveFromSan(g[y],o);if(A==null)if(An.indexOf(g[y])>-1)v=g[y];else throw new Error(`Invalid move in PGN: ${g[y]}`);else v="",this._makeMove(A)}v&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",v)}_moveToSan(t,o){let n="";if(t.flags&_.KSIDE_CASTLE)n="O-O";else if(t.flags&_.QSIDE_CASTLE)n="O-O-O";else{if(t.piece!==N){const r=On(t,o);n+=t.piece.toUpperCase()+r}t.flags&(_.CAPTURE|_.EP_CAPTURE)&&(t.piece===N&&(n+=H(t.from)[0]),n+="x"),n+=H(t.to),t.promotion&&(n+="="+t.promotion.toUpperCase())}return this._makeMove(t),this.isCheck()&&(this.isCheckmate()?n+="#":n+="+"),this._undoMove(),n}_moveFromSan(t,o=!1){const n=et(t);let r=qt(n),s=this._moves({legal:!0,piece:r});for(let p=0,w=s.length;p<w;p++)if(n===et(this._moveToSan(s[p],s)))return s[p];if(o)return null;let i,a,c,l,d,f=!1;if(a=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),a?(i=a[1],c=a[2],l=a[3],d=a[4],c.length==1&&(f=!0)):(a=n.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),a&&(i=a[1],c=a[2],l=a[3],d=a[4],c.length==1&&(f=!0))),r=qt(n),s=this._moves({legal:!0,piece:i||r}),!l)return null;for(let p=0,w=s.length;p<w;p++)if(c){if((!i||i.toLowerCase()==s[p].piece)&&S[c]==s[p].from&&S[l]==s[p].to&&(!d||d.toLowerCase()==s[p].promotion))return s[p];if(f){const u=H(s[p].from);if((!i||i.toLowerCase()==s[p].piece)&&S[l]==s[p].to&&(c==u[0]||c==u[1])&&(!d||d.toLowerCase()==s[p].promotion))return s[p]}}else if(n===et(this._moveToSan(s[p],s)).replace("x",""))return s[p];return null}ascii(){let t=`   +------------------------+
`;for(let o=S.a8;o<=S.h1;o++){if(_e(o)===0&&(t+=" "+"87654321"[le(o)]+" |"),this._board[o]){const n=this._board[o].type,r=this._board[o].color===L?n.toUpperCase():n.toLowerCase();t+=" "+r+" "}else t+=" . ";o+1&136&&(t+=`|
`,o+=8)}return t+=`   +------------------------+
`,t+="     a  b  c  d  e  f  g  h",t}perft(t){const o=this._moves({legal:!1});let n=0;const r=this._turn;for(let s=0,i=o.length;s<i;s++)this._makeMove(o[s]),this._isKingAttacked(r)||(t-1>0?n+=this.perft(t-1):n++),this._undoMove();return n}_makePretty(t){const{color:o,piece:n,from:r,to:s,flags:i,captured:a,promotion:c}=t;let l="";for(const w in _)_[w]&i&&(l+=bn[w]);const d=H(r),f=H(s),p={color:o,piece:n,from:d,to:f,san:this._moveToSan(t,this._moves({legal:!0})),flags:l,lan:d+f,before:this.fen(),after:""};return this._makeMove(t),p.after=this.fen(),this._undoMove(),a&&(p.captured=a),c&&(p.promotion=c,p.lan+=c),p}turn(){return this._turn}board(){const t=[];let o=[];for(let n=S.a8;n<=S.h1;n++)this._board[n]==null?o.push(null):o.push({square:H(n),type:this._board[n].type,color:this._board[n].color}),n+1&136&&(t.push(o),o=[],n+=8);return t}squareColor(t){if(t in S){const o=S[t];return(le(o)+_e(o))%2===0?"light":"dark"}return null}history({verbose:t=!1}={}){const o=[],n=[];for(;this._history.length>0;)o.push(this._undoMove());for(;;){const r=o.pop();if(!r)break;t?n.push(this._makePretty(r)):n.push(this._moveToSan(r,this._moves())),this._makeMove(r)}return n}_pruneComments(){const t=[],o={},n=r=>{r in this._comments&&(o[r]=this._comments[r])};for(;this._history.length>0;)t.push(this._undoMove());for(n(this.fen());;){const r=t.pop();if(!r)break;this._makeMove(r),n(this.fen())}this._comments=o}getComment(){return this._comments[this.fen()]}setComment(t){this._comments[this.fen()]=t.replace("{","[").replace("}","]")}deleteComment(){const t=this._comments[this.fen()];return delete this._comments[this.fen()],t}getComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>({fen:t,comment:this._comments[t]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>{const o=this._comments[t];return delete this._comments[t],{fen:t,comment:o}})}setCastlingRights(t,o){for(const r of[x,te])o[r]!==void 0&&(o[r]?this._castling[t]|=xe[r]:this._castling[t]&=~xe[r]);this._updateCastlingRights();const n=this.getCastlingRights(t);return(o[x]===void 0||o[x]===n[x])&&(o[te]===void 0||o[te]===n[te])}getCastlingRights(t){return{[x]:(this._castling[t]&xe[x])!==0,[te]:(this._castling[t]&xe[te])!==0}}moveNumber(){return this._moveNumber}}function Nn(e){const t=[];for(const o of e)t.push({orig:o.to,brush:"yellow"}),o.captured&&t.push({orig:o.from,dest:o.to,brush:"red"}),o.san.includes("+")&&t.push({orig:o.from,dest:o.to,brush:"blue"});return t}function Be(e){return e==="w"?"white":"black"}function Ft(e){const t=new Map;for(const o of yn){const n=e.moves({square:o,verbose:!0});n.length&&t.set(n[0].from,n.map(r=>r.to))}return t}function xn(e,t){if((t==null?void 0:t.type)!=="p")return!1;const o=(t==null?void 0:t.color)==="w"?"8":"1";return e[1]===o}function Ee(e){return!!e&&e instanceof Object&&!(e instanceof Array)&&!(e instanceof Function)}function Le(e){return Ee(e)?Object.fromEntries(Object.entries(e).map(([t,o])=>[t,Le(o)])):e}function Ut(e,t){const o={...e,...t};for(const n in o)o[n]=Ee(e==null?void 0:e[n])&&Ee(t==null?void 0:t[n])?Ut(e[n],t[n]):Le(o[n]);return o}function $t(e,t){const o={};for(const n in t)if(Ee(e==null?void 0:e[n])&&Ee(t==null?void 0:t[n])){const r=$t(e[n],t[n]);Object.keys(r).length>0&&(o[n]=r)}else(e==null?void 0:e[n])!==t[n]&&(o[n]=t[n]);return o}const Bn={p:"pawn",n:"knight",b:"bishop",r:"rook",q:"queen",k:"king"},Ln=new Map([["b1",["a3","c3"]],["g1",["f3","h3"]],["a2",["a3","a4"]],["b2",["b3","b4"]],["c2",["c3","c4"]],["d2",["d3","d4"]],["e2",["e3","e4"]],["f2",["f3","f4"]],["g2",["g3","g4"]],["h2",["h3","h4"]]]),In="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Dn={fen:In,orientation:"white",turnColor:"white",coordinates:!1,autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!1,blockTouchScroll:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:300},lastMove:void 0,movable:{free:!1,color:"white",showDests:!0,dests:Ln,events:{after:()=>{},afterNewPiece:void 0},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{set:void 0,unset:void 0}},predroppable:{enabled:!1,events:{set:void 0,unset:void 0}},draggable:{enabled:!0,distance:3,autoDistance:!0,showGhost:!0,deleteOnDropOff:!1},selectable:{enabled:!0},events:{change:void 0,move:void 0,dropNewPiece:void 0,select:void 0,insert:void 0},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}}}},qn=["white","black"],tt=["a","b","c","d","e","f","g","h"],ot=["1","2","3","4","5","6","7","8"],Fn=[...ot].reverse(),nt=Array.prototype.concat(...tt.map(e=>ot.map(t=>e+t))),z=e=>nt[8*e[0]+e[1]],P=e=>[e.charCodeAt(0)-97,e.charCodeAt(1)-49],jt=nt.map(P);function Un(e){let t;const o=()=>(t===void 0&&(t=e()),t);return o.clear=()=>{t=void 0},o}const $n=()=>{let e;return{start(){e=performance.now()},cancel(){e=void 0},stop(){if(!e)return 0;const t=performance.now()-e;return e=void 0,t}}},rt=e=>e==="white"?"black":"white",ke=(e,t)=>{const o=e[0]-t[0],n=e[1]-t[1];return o*o+n*n},st=(e,t)=>e.role===t.role&&e.color===t.color,Ce=e=>(t,o)=>[(o?t[0]:7-t[0])*e.width/8,(o?7-t[1]:t[1])*e.height/8],J=(e,t)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px)`},Vt=(e,t,o=1)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px) scale(${o})`},it=(e,t)=>{e.style.visibility=t?"visible":"hidden"},de=e=>{var t;if(e.clientX||e.clientX===0)return[e.clientX,e.clientY];if(!((t=e.targetTouches)===null||t===void 0)&&t[0])return[e.targetTouches[0].clientX,e.targetTouches[0].clientY]},Ht=e=>e.buttons===2||e.button===2,Y=(e,t)=>{const o=document.createElement(e);return t&&(o.className=t),o};function Kt(e,t,o){const n=P(e);return t||(n[0]=7-n[0],n[1]=7-n[1]),[o.left+o.width*n[0]/8+o.width/16,o.top+o.height*(7-n[1])/8+o.height/16]}const ue=(e,t)=>Math.abs(e-t),jn=e=>(t,o,n,r)=>ue(t,n)<2&&(e==="white"?r===o+1||o<=1&&r===o+2&&t===n:r===o-1||o>=6&&r===o-2&&t===n),Wt=(e,t,o,n)=>{const r=ue(e,o),s=ue(t,n);return r===1&&s===2||r===2&&s===1},zt=(e,t,o,n)=>ue(e,o)===ue(t,n),Gt=(e,t,o,n)=>e===o||t===n,Qt=(e,t,o,n)=>zt(e,t,o,n)||Gt(e,t,o,n),Vn=(e,t,o)=>(n,r,s,i)=>ue(n,s)<2&&ue(r,i)<2||o&&r===i&&r===(e==="white"?0:7)&&(n===4&&(s===2&&t.includes(0)||s===6&&t.includes(7))||t.includes(s));function Hn(e,t){const o=t==="white"?"1":"8",n=[];for(const[r,s]of e)r[1]===o&&s.color===t&&s.role==="rook"&&n.push(P(r)[0]);return n}function Jt(e,t,o){const n=e.get(t);if(!n)return[];const r=P(t),s=n.role,i=s==="pawn"?jn(n.color):s==="knight"?Wt:s==="bishop"?zt:s==="rook"?Gt:s==="queen"?Qt:Vn(n.color,Hn(e,n.color),o);return jt.filter(a=>(r[0]!==a[0]||r[1]!==a[1])&&i(r[0],r[1],a[0],a[1])).map(z)}function F(e,...t){e&&setTimeout(()=>e(...t),1)}function Kn(e){e.orientation=rt(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0}function Wn(e,t){for(const[o,n]of t)n?e.pieces.set(o,n):e.pieces.delete(o)}function zn(e,t){if(e.check=void 0,t===!0&&(t=e.turnColor),t)for(const[o,n]of e.pieces)n.role==="king"&&n.color===t&&(e.check=o)}function Gn(e,t,o,n){se(e),e.premovable.current=[t,o],F(e.premovable.events.set,t,o,n)}function re(e){e.premovable.current&&(e.premovable.current=void 0,F(e.premovable.events.unset))}function Qn(e,t,o){re(e),e.predroppable.current={role:t,key:o},F(e.predroppable.events.set,t,o)}function se(e){const t=e.predroppable;t.current&&(t.current=void 0,F(t.events.unset))}function Jn(e,t,o){if(!e.autoCastle)return!1;const n=e.pieces.get(t);if(!n||n.role!=="king")return!1;const r=P(t),s=P(o);if(r[1]!==0&&r[1]!==7||r[1]!==s[1])return!1;r[0]===4&&!e.pieces.has(o)&&(s[0]===6?o=z([7,s[1]]):s[0]===2&&(o=z([0,s[1]])));const i=e.pieces.get(o);return!i||i.color!==n.color||i.role!=="rook"?!1:(e.pieces.delete(t),e.pieces.delete(o),r[0]<s[0]?(e.pieces.set(z([6,s[1]]),n),e.pieces.set(z([5,s[1]]),i)):(e.pieces.set(z([2,s[1]]),n),e.pieces.set(z([3,s[1]]),i)),!0)}function Xt(e,t,o){const n=e.pieces.get(t),r=e.pieces.get(o);if(t===o||!n)return!1;const s=r&&r.color!==n.color?r:void 0;return o===e.selected&&G(e),F(e.events.move,t,o,s),Jn(e,t,o)||(e.pieces.set(o,n),e.pieces.delete(t)),e.lastMove=[t,o],e.check=void 0,F(e.events.change),s||!0}function at(e,t,o,n){if(e.pieces.has(o))if(n)e.pieces.delete(o);else return!1;return F(e.events.dropNewPiece,t,o),e.pieces.set(o,t),e.lastMove=[o],e.check=void 0,F(e.events.change),e.movable.dests=void 0,e.turnColor=rt(e.turnColor),!0}function Zt(e,t,o){const n=Xt(e,t,o);return n&&(e.movable.dests=void 0,e.turnColor=rt(e.turnColor),e.animation.current=void 0),n}function Yt(e,t,o){if(lt(e,t,o)){const n=Zt(e,t,o);if(n){const r=e.hold.stop();G(e);const s={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:r};return n!==!0&&(s.captured=n),F(e.movable.events.after,t,o,s),!0}}else if(Zn(e,t,o))return Gn(e,t,o,{ctrlKey:e.stats.ctrlKey}),G(e),!0;return G(e),!1}function eo(e,t,o,n){const r=e.pieces.get(t);r&&(Xn(e,t,o)||n)?(e.pieces.delete(t),at(e,r,o,n),F(e.movable.events.afterNewPiece,r.role,o,{premove:!1,predrop:!1})):r&&Yn(e,t,o)?Qn(e,r.role,o):(re(e),se(e)),e.pieces.delete(t),G(e)}function ct(e,t,o){if(F(e.events.select,t),e.selected){if(e.selected===t&&!e.draggable.enabled){G(e),e.hold.cancel();return}else if((e.selectable.enabled||o)&&e.selected!==t&&Yt(e,e.selected,t)){e.stats.dragged=!1;return}}(e.selectable.enabled||e.draggable.enabled)&&(oo(e,t)||dt(e,t))&&(to(e,t),e.hold.start())}function to(e,t){e.selected=t,dt(e,t)?e.premovable.customDests||(e.premovable.dests=Jt(e.pieces,t,e.premovable.castle)):e.premovable.dests=void 0}function G(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function oo(e,t){const o=e.pieces.get(t);return!!o&&(e.movable.color==="both"||e.movable.color===o.color&&e.turnColor===o.color)}const lt=(e,t,o)=>{var n,r;return t!==o&&oo(e,t)&&(e.movable.free||!!(!((r=(n=e.movable.dests)===null||n===void 0?void 0:n.get(t))===null||r===void 0)&&r.includes(o)))};function Xn(e,t,o){const n=e.pieces.get(t);return!!n&&(t===o||!e.pieces.has(o))&&(e.movable.color==="both"||e.movable.color===n.color&&e.turnColor===n.color)}function dt(e,t){const o=e.pieces.get(t);return!!o&&e.premovable.enabled&&e.movable.color===o.color&&e.turnColor!==o.color}function Zn(e,t,o){var n,r;const s=(r=(n=e.premovable.customDests)===null||n===void 0?void 0:n.get(t))!==null&&r!==void 0?r:Jt(e.pieces,t,e.premovable.castle);return t!==o&&dt(e,t)&&s.includes(o)}function Yn(e,t,o){const n=e.pieces.get(t),r=e.pieces.get(o);return!!n&&(!r||r.color!==e.movable.color)&&e.predroppable.enabled&&(n.role!=="pawn"||o[1]!=="1"&&o[1]!=="8")&&e.movable.color===n.color&&e.turnColor!==n.color}function er(e,t){const o=e.pieces.get(t);return!!o&&e.draggable.enabled&&(e.movable.color==="both"||e.movable.color===o.color&&(e.turnColor===o.color||e.premovable.enabled))}function tr(e){const t=e.premovable.current;if(!t)return!1;const o=t[0],n=t[1];let r=!1;if(lt(e,o,n)){const s=Zt(e,o,n);if(s){const i={premove:!0};s!==!0&&(i.captured=s),F(e.movable.events.after,o,n,i),r=!0}}return re(e),r}function or(e,t){const o=e.predroppable.current;let n=!1;if(!o)return!1;if(t(o)){const r={role:o.role,color:e.movable.color};at(e,r,o.key)&&(F(e.movable.events.afterNewPiece,o.role,o.key,{premove:!1,predrop:!0}),n=!0)}return se(e),n}function ut(e){re(e),se(e),G(e)}function no(e){e.movable.color=e.movable.dests=e.animation.current=void 0,ut(e)}function he(e,t,o){let n=Math.floor(8*(e[0]-o.left)/o.width);t||(n=7-n);let r=7-Math.floor(8*(e[1]-o.top)/o.height);return t||(r=7-r),n>=0&&n<8&&r>=0&&r<8?z([n,r]):void 0}function nr(e,t,o,n){const r=P(e),s=jt.filter(c=>Qt(r[0],r[1],c[0],c[1])||Wt(r[0],r[1],c[0],c[1])),i=s.map(c=>Kt(z(c),o,n)).map(c=>ke(t,c)),[,a]=i.reduce((c,l,d)=>c[0]<l?c:[l,d],[i[0],0]);return z(s[a])}const U=e=>e.orientation==="white",ro="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",rr={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},sr={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};function so(e){e==="start"&&(e=ro);const t=new Map;let o=7,n=0;for(const r of e)switch(r){case" ":case"[":return t;case"/":if(--o,o<0)return t;n=0;break;case"~":{const s=t.get(z([n-1,o]));s&&(s.promoted=!0);break}default:{const s=r.charCodeAt(0);if(s<57)n+=s-48;else{const i=r.toLowerCase();t.set(z([n,o]),{role:rr[i],color:r===i?"black":"white"}),++n}}}return t}function ir(e){return Fn.map(t=>tt.map(o=>{const n=e.get(o+t);if(n){let r=sr[n.role];return n.color==="white"&&(r=r.toUpperCase()),n.promoted&&(r+="~"),r}else return"1"}).join("")).join("/").replace(/1{2,}/g,t=>t.length.toString())}function io(e,t){t.animation&&(ht(e.animation,t.animation),(e.animation.duration||0)<70&&(e.animation.enabled=!1))}function ao(e,t){var o,n,r;if(!((o=t.movable)===null||o===void 0)&&o.dests&&(e.movable.dests=void 0),!((n=t.drawable)===null||n===void 0)&&n.autoShapes&&(e.drawable.autoShapes=[]),ht(e,t),t.fen&&(e.pieces=so(t.fen),e.drawable.shapes=((r=t.drawable)===null||r===void 0?void 0:r.shapes)||[]),"check"in t&&zn(e,t.check||!1),"lastMove"in t&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&to(e,e.selected),io(e,t),!e.movable.rookCastle&&e.movable.dests){const s=e.movable.color==="white"?"1":"8",i="e"+s,a=e.movable.dests.get(i),c=e.pieces.get(i);if(!a||!c||c.role!=="king")return;e.movable.dests.set(i,a.filter(l=>!(l==="a"+s&&a.includes("c"+s))&&!(l==="h"+s&&a.includes("g"+s))))}}function ht(e,t){for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(Object.prototype.hasOwnProperty.call(e,o)&&co(e[o])&&co(t[o])?ht(e[o],t[o]):e[o]=t[o])}function co(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}const fe=(e,t)=>t.animation.enabled?lr(e,t):ie(e,t);function ie(e,t){const o=e(t);return t.dom.redraw(),o}const ft=(e,t)=>({key:e,pos:P(e),piece:t}),ar=(e,t)=>t.sort((o,n)=>ke(e.pos,o.pos)-ke(e.pos,n.pos))[0];function cr(e,t){const o=new Map,n=[],r=new Map,s=[],i=[],a=new Map;let c,l,d;for(const[f,p]of e)a.set(f,ft(f,p));for(const f of nt)c=t.pieces.get(f),l=a.get(f),c?l?st(c,l.piece)||(s.push(l),i.push(ft(f,c))):i.push(ft(f,c)):l&&s.push(l);for(const f of i)l=ar(f,s.filter(p=>st(f.piece,p.piece))),l&&(d=[l.pos[0]-f.pos[0],l.pos[1]-f.pos[1]],o.set(f.key,d.concat(d)),n.push(l.key));for(const f of s)n.includes(f.key)||r.set(f.key,f.piece);return{anims:o,fadings:r}}function lo(e,t){const o=e.animation.current;if(o===void 0){e.dom.destroyed||e.dom.redrawNow();return}const n=1-(t-o.start)*o.frequency;if(n<=0)e.animation.current=void 0,e.dom.redrawNow();else{const r=dr(n);for(const s of o.plan.anims.values())s[2]=s[0]*r,s[3]=s[1]*r;e.dom.redrawNow(!0),requestAnimationFrame((s=performance.now())=>lo(e,s))}}function lr(e,t){const o=new Map(t.pieces),n=e(t),r=cr(o,t);if(r.anims.size||r.fadings.size){const s=t.animation.current&&t.animation.current.start;t.animation.current={start:performance.now(),frequency:1/t.animation.duration,plan:r},s||lo(t,performance.now())}else t.dom.redraw();return n}const dr=e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,ur=["green","red","blue","yellow"];function hr(e,t){if(t.touches&&t.touches.length>1)return;t.stopPropagation(),t.preventDefault(),t.ctrlKey?G(e):ut(e);const o=de(t),n=he(o,U(e),e.dom.bounds());n&&(e.drawable.current={orig:n,pos:o,brush:gr(t),snapToValidMove:e.drawable.defaultSnapToValidMove},uo(e))}function uo(e){requestAnimationFrame(()=>{const t=e.drawable.current;if(t){const o=he(t.pos,U(e),e.dom.bounds());o||(t.snapToValidMove=!1);const n=t.snapToValidMove?nr(t.orig,t.pos,U(e),e.dom.bounds()):o;n!==t.mouseSq&&(t.mouseSq=n,t.dest=n!==t.orig?n:void 0,e.dom.redrawNow()),uo(e)}})}function fr(e,t){e.drawable.current&&(e.drawable.current.pos=de(t))}function pr(e){const t=e.drawable.current;t&&(t.mouseSq&&br(e.drawable,t),ho(e))}function ho(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function mr(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),fo(e.drawable))}function gr(e){var t;const o=(e.shiftKey||e.ctrlKey)&&Ht(e),n=e.altKey||e.metaKey||((t=e.getModifierState)===null||t===void 0?void 0:t.call(e,"AltGraph"));return ur[(o?1:0)+(n?2:0)]}function br(e,t){const o=r=>r.orig===t.orig&&r.dest===t.dest,n=e.shapes.find(o);n&&(e.shapes=e.shapes.filter(r=>!o(r))),(!n||n.brush!==t.brush)&&e.shapes.push({orig:t.orig,dest:t.dest,brush:t.brush}),fo(e)}function fo(e){e.onChange&&e.onChange(e.shapes)}function yr(e,t){if(!(e.trustAllEvents||t.isTrusted)||t.button!==void 0&&t.button!==0||t.touches&&t.touches.length>1)return;const o=e.dom.bounds(),n=de(t),r=he(n,U(e),o);if(!r)return;const s=e.pieces.get(r),i=e.selected;if(!i&&e.drawable.enabled&&(e.drawable.eraseOnClick||!s||s.color!==e.turnColor)&&mr(e),t.cancelable!==!1&&(!t.touches||e.blockTouchScroll||s||i||wr(e,n)))t.preventDefault();else if(t.touches)return;const a=!!e.premovable.current,c=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&lt(e,e.selected,r)?fe(f=>ct(f,r),e):ct(e,r);const l=e.selected===r,d=mo(e,r);if(s&&d&&l&&er(e,r)){e.draggable.current={orig:r,piece:s,origPos:n,pos:n,started:e.draggable.autoDistance&&e.stats.dragged,element:d,previouslySelected:i,originTarget:t.target,keyHasChanged:!1},d.cgDragging=!0,d.classList.add("dragging");const f=e.dom.elements.ghost;f&&(f.className=`ghost ${s.color} ${s.role}`,J(f,Ce(o)(P(r),U(e))),it(f,!0)),pt(e)}else a&&re(e),c&&se(e);e.dom.redraw()}function wr(e,t){const o=U(e),n=e.dom.bounds(),r=Math.pow(n.width/8,2);for(const s of e.pieces.keys()){const i=Kt(s,o,n);if(ke(i,t)<=r)return!0}return!1}function vr(e,t,o,n){const r="a0";e.pieces.set(r,t),e.dom.redraw();const s=de(o);e.draggable.current={orig:r,piece:t,origPos:s,pos:s,started:!0,element:()=>mo(e,r),originTarget:o.target,newPiece:!0,force:!!n,keyHasChanged:!1},pt(e)}function pt(e){requestAnimationFrame(()=>{var t;const o=e.draggable.current;if(!o)return;!((t=e.animation.current)===null||t===void 0)&&t.plan.anims.has(o.orig)&&(e.animation.current=void 0);const n=e.pieces.get(o.orig);if(!n||!st(n,o.piece))Ie(e);else if(!o.started&&ke(o.pos,o.origPos)>=Math.pow(e.draggable.distance,2)&&(o.started=!0),o.started){if(typeof o.element=="function"){const s=o.element();if(!s)return;s.cgDragging=!0,s.classList.add("dragging"),o.element=s}const r=e.dom.bounds();J(o.element,[o.pos[0]-r.left-r.width/16,o.pos[1]-r.top-r.height/16]),o.keyHasChanged||(o.keyHasChanged=o.orig!==he(o.pos,U(e),r))}pt(e)})}function _r(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.pos=de(t))}function Sr(e,t){const o=e.draggable.current;if(!o)return;if(t.type==="touchend"&&t.cancelable!==!1&&t.preventDefault(),t.type==="touchend"&&o.originTarget!==t.target&&!o.newPiece){e.draggable.current=void 0;return}re(e),se(e);const n=de(t)||o.pos,r=he(n,U(e),e.dom.bounds());r&&o.started&&o.orig!==r?o.newPiece?eo(e,o.orig,r,o.force):(e.stats.ctrlKey=t.ctrlKey,Yt(e,o.orig,r)&&(e.stats.dragged=!0)):o.newPiece?e.pieces.delete(o.orig):e.draggable.deleteOnDropOff&&!r&&(e.pieces.delete(o.orig),F(e.events.change)),(o.orig===o.previouslySelected||o.keyHasChanged)&&(o.orig===r||!r)?G(e):e.selectable.enabled||G(e),po(e),e.draggable.current=void 0,e.dom.redraw()}function Ie(e){const t=e.draggable.current;t&&(t.newPiece&&e.pieces.delete(t.orig),e.draggable.current=void 0,G(e),po(e),e.dom.redraw())}function po(e){const t=e.dom.elements;t.ghost&&it(t.ghost,!1)}function mo(e,t){let o=e.dom.elements.board.firstChild;for(;o;){if(o.cgKey===t&&o.tagName==="PIECE")return o;o=o.nextSibling}}function Er(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(()=>{go(e,2),setTimeout(()=>go(e,void 0),120)},120)}function go(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}function kr(e,t){function o(){Kn(e),t()}return{set(n){n.orientation&&n.orientation!==e.orientation&&o(),io(e,n),(n.fen?fe:ie)(r=>ao(r,n),e)},state:e,getFen:()=>ir(e.pieces),toggleOrientation:o,setPieces(n){fe(r=>Wn(r,n),e)},selectSquare(n,r){n?fe(s=>ct(s,n,r),e):e.selected&&(G(e),e.dom.redraw())},move(n,r){fe(s=>Xt(s,n,r),e)},newPiece(n,r){fe(s=>at(s,n,r),e)},playPremove(){if(e.premovable.current){if(fe(tr,e))return!0;e.dom.redraw()}return!1},playPredrop(n){if(e.predroppable.current){const r=or(e,n);return e.dom.redraw(),r}return!1},cancelPremove(){ie(re,e)},cancelPredrop(){ie(se,e)},cancelMove(){ie(n=>{ut(n),Ie(n)},e)},stop(){ie(n=>{no(n),Ie(n)},e)},explode(n){Er(e,n)},setAutoShapes(n){ie(r=>r.drawable.autoShapes=n,e)},setShapes(n){ie(r=>r.drawable.shapes=n,e)},getKeyAtDomPos(n){return he(n,U(e),e.dom.bounds())},redrawAll:t,dragNewPiece(n,r,s){vr(e,n,r,s)},destroy(){no(e),e.dom.unbind&&e.dom.unbind(),e.dom.destroyed=!0}}}function Cr(){return{pieces:so(ro),orientation:"white",turnColor:"white",coordinates:!0,ranksPosition:"right",autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!1,blockTouchScroll:!1,pieceKey:!1,trustAllEvents:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,showGhost:!0,deleteOnDropOff:!1},dropmode:{active:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15},purple:{key:"purp",color:"#68217a",opacity:.65,lineWidth:10},pink:{key:"pink",color:"#ee2080",opacity:.5,lineWidth:10},hilite:{key:"hilite",color:"#fff",opacity:1,lineWidth:1}},prevSvgHash:""},hold:$n()}}function Tr(){const e=M("defs"),t=D(M("filter"),{id:"cg-filter-blur"});return t.appendChild(D(M("feGaussianBlur"),{stdDeviation:"0.022"})),e.appendChild(t),e}function Pr(e,t,o){var n;const r=e.drawable,s=r.current,i=s&&s.mouseSq?s:void 0,a=new Map,c=e.dom.bounds(),l=r.autoShapes.filter(w=>!w.piece);for(const w of r.shapes.concat(l).concat(i?[i]:[])){if(!w.dest)continue;const u=(n=a.get(w.dest))!==null&&n!==void 0?n:new Set,m=qe(De(P(w.orig),e.orientation),c),g=qe(De(P(w.dest),e.orientation),c);u.add(gt(m,g)),a.set(w.dest,u)}const d=r.shapes.concat(l).map(w=>({shape:w,current:!1,hash:bo(w,mt(w.dest,a),!1,c)}));i&&d.push({shape:i,current:!0,hash:bo(i,mt(i.dest,a),!0,c)});const f=d.map(w=>w.hash).join(";");if(f===e.drawable.prevSvgHash)return;e.drawable.prevSvgHash=f;const p=t.querySelector("defs");Ar(r,d,p),Rr(d,t.querySelector("g"),o.querySelector("g"),w=>Nr(e,w,r.brushes,a,c))}function Ar(e,t,o){var n;const r=new Map;let s;for(const c of t.filter(l=>l.shape.dest&&l.shape.brush))s=wo(e.brushes[c.shape.brush],c.shape.modifiers),!((n=c.shape.modifiers)===null||n===void 0)&&n.hilite&&r.set("hilite",e.brushes.hilite),r.set(s.key,s);const i=new Set;let a=o.firstElementChild;for(;a;)i.add(a.getAttribute("cgKey")),a=a.nextElementSibling;for(const[c,l]of r.entries())i.has(c)||o.appendChild(Lr(l))}function Rr(e,t,o,n){const r=new Map;for(const s of e)r.set(s.hash,!1);for(const s of[t,o]){const i=[];let a=s.firstElementChild,c;for(;a;)c=a.getAttribute("cgHash"),r.has(c)?r.set(c,!0):i.push(a),a=a.nextElementSibling;for(const l of i)s.removeChild(l)}for(const s of e.filter(i=>!r.get(i.hash)))for(const i of n(s))i.isCustom?o.appendChild(i.el):t.appendChild(i.el)}function bo({orig:e,dest:t,brush:o,piece:n,modifiers:r,customSvg:s,label:i},a,c,l){var d,f;return[l.width,l.height,c,e,t,o,a&&"-",n&&Or(n),r&&Mr(r),s&&`custom-${yo(s.html)},${(f=(d=s.center)===null||d===void 0?void 0:d[0])!==null&&f!==void 0?f:"o"}`,i&&`label-${yo(i.text)}`].filter(p=>p).join(",")}function Or(e){return[e.color,e.role,e.scale].filter(t=>t).join(",")}function Mr(e){return[e.lineWidth,e.hilite&&"*"].filter(t=>t).join(",")}function yo(e){let t=0;for(let o=0;o<e.length;o++)t=(t<<5)-t+e.charCodeAt(o)>>>0;return t.toString()}function Nr(e,{shape:t,current:o,hash:n},r,s,i){var a,c;const l=qe(De(P(t.orig),e.orientation),i),d=t.dest?qe(De(P(t.dest),e.orientation),i):l,f=t.brush&&wo(r[t.brush],t.modifiers),p=s.get(t.dest),w=[];if(f){const u=D(M("g"),{cgHash:n});w.push({el:u}),l[0]!==d[0]||l[1]!==d[1]?u.appendChild(Br(t,f,l,d,o,mt(t.dest,s))):u.appendChild(xr(r[t.brush],l,o,i))}if(t.label){const u=t.label;(a=u.fill)!==null&&a!==void 0||(u.fill=t.brush&&r[t.brush].color);const m=t.brush?void 0:"tr";w.push({el:Ir(u,n,l,d,p,m),isCustom:!0})}if(t.customSvg){const u=(c=t.customSvg.center)!==null&&c!==void 0?c:"orig",[m,g]=u==="label"?_o(l,d,p).map(y=>y-.5):u==="dest"?d:l,v=D(M("g"),{transform:`translate(${m},${g})`,cgHash:n});v.innerHTML=`<svg width="1" height="1" viewBox="0 0 100 100">${t.customSvg.html}</svg>`,w.push({el:v,isCustom:!0})}return w}function xr(e,t,o,n){const r=Dr(),s=(n.width+n.height)/(4*Math.max(n.width,n.height));return D(M("circle"),{stroke:e.color,"stroke-width":r[o?0:1],fill:"none",opacity:vo(e,o),cx:t[0],cy:t[1],r:s-r[1]/2})}function Br(e,t,o,n,r,s){var i;function a(d){var f;const p=Fr(s&&!r),w=n[0]-o[0],u=n[1]-o[1],m=Math.atan2(u,w),g=Math.cos(m)*p,v=Math.sin(m)*p;return D(M("line"),{stroke:d?"white":t.color,"stroke-width":qr(t,r)+(d?.04:0),"stroke-linecap":"round","marker-end":`url(#arrowhead-${d?"hilite":t.key})`,opacity:!((f=e.modifiers)===null||f===void 0)&&f.hilite?1:vo(t,r),x1:o[0],y1:o[1],x2:n[0]-g,y2:n[1]-v})}if(!(!((i=e.modifiers)===null||i===void 0)&&i.hilite))return a(!1);const c=M("g"),l=D(M("g"),{filter:"url(#cg-filter-blur)"});return l.appendChild(Ur(o,n)),l.appendChild(a(!0)),c.appendChild(l),c.appendChild(a(!1)),c}function Lr(e){const t=D(M("marker"),{id:"arrowhead-"+e.key,orient:"auto",overflow:"visible",markerWidth:4,markerHeight:4,refX:e.key==="hilite"?1.86:2.05,refY:2});return t.appendChild(D(M("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function Ir(e,t,o,n,r,s){var i;const a=.4*.75**e.text.length,c=_o(o,n,r),l=s==="tr"?.4:0,d=D(M("g"),{transform:`translate(${c[0]+l},${c[1]-l})`,cgHash:t});d.appendChild(D(M("circle"),{r:.4/2,"fill-opacity":s?1:.8,"stroke-opacity":s?1:.7,"stroke-width":.03,fill:(i=e.fill)!==null&&i!==void 0?i:"#666",stroke:"white"}));const f=D(M("text"),{"font-size":a,"font-family":"Noto Sans","text-anchor":"middle",fill:"white",y:.13*.75**e.text.length});return f.innerHTML=e.text,d.appendChild(f),d}function De(e,t){return t==="white"?e:[7-e[0],7-e[1]]}function mt(e,t){return(e&&t.has(e)&&t.get(e).size>1)===!0}function M(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function D(e,t){for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.setAttribute(o,t[o]);return e}function wo(e,t){return t?{color:e.color,opacity:Math.round(e.opacity*10)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth),key:[e.key,t.lineWidth].filter(o=>o).join("")}:e}function Dr(){return[3/64,4/64]}function qr(e,t){return(e.lineWidth||10)*(t?.85:1)/64}function vo(e,t){return(e.opacity||1)*(t?.9:1)}function Fr(e){return(e?20:10)/64}function qe(e,t){const o=Math.min(1,t.width/t.height),n=Math.min(1,t.height/t.width);return[(e[0]-3.5)*o,(3.5-e[1])*n]}function Ur(e,t){const o={from:[Math.floor(Math.min(e[0],t[0])),Math.floor(Math.min(e[1],t[1]))],to:[Math.ceil(Math.max(e[0],t[0])),Math.ceil(Math.max(e[1],t[1]))]};return D(M("rect"),{x:o.from[0],y:o.from[1],width:o.to[0]-o.from[0],height:o.to[1]-o.from[1],fill:"none",stroke:"none"})}function gt(e,t,o=!0){const n=Math.atan2(t[1]-e[1],t[0]-e[0])+Math.PI;return o?(Math.round(n*8/Math.PI)+16)%16:n}function $r(e,t){return Math.sqrt([e[0]-t[0],e[1]-t[1]].reduce((o,n)=>o+n*n,0))}function _o(e,t,o){let n=$r(e,t);const r=gt(e,t,!1);if(o&&(n-=33/64,o.size>1)){n-=10/64;const s=gt(e,t);(o.has((s+1)%16)||o.has((s+15)%16))&&s&1&&(n-=.4)}return[e[0]-Math.cos(r)*n,e[1]-Math.sin(r)*n].map(s=>s+.5)}function jr(e,t){e.innerHTML="",e.classList.add("cg-wrap");for(const c of qn)e.classList.toggle("orientation-"+c,t.orientation===c);e.classList.toggle("manipulable",!t.viewOnly);const o=Y("cg-container");e.appendChild(o);const n=Y("cg-board");o.appendChild(n);let r,s,i;if(t.drawable.visible&&(r=D(M("svg"),{class:"cg-shapes",viewBox:"-4 -4 8 8",preserveAspectRatio:"xMidYMid slice"}),r.appendChild(Tr()),r.appendChild(M("g")),s=D(M("svg"),{class:"cg-custom-svgs",viewBox:"-3.5 -3.5 8 8",preserveAspectRatio:"xMidYMid slice"}),s.appendChild(M("g")),i=Y("cg-auto-pieces"),o.appendChild(r),o.appendChild(s),o.appendChild(i)),t.coordinates){const c=t.orientation==="black"?" black":"",l=t.ranksPosition==="left"?" left":"";o.appendChild(So(ot,"ranks"+c+l)),o.appendChild(So(tt,"files"+c))}let a;return t.draggable.enabled&&t.draggable.showGhost&&(a=Y("piece","ghost"),it(a,!1),o.appendChild(a)),{board:n,container:o,wrap:e,ghost:a,svg:r,customSvg:s,autoPieces:i}}function So(e,t){const o=Y("coords",t);let n;for(const r of e)n=Y("coord"),n.textContent=r,o.appendChild(n);return o}function Vr(e,t){if(!e.dropmode.active)return;re(e),se(e);const o=e.dropmode.piece;if(o){e.pieces.set("a0",o);const n=de(t),r=n&&he(n,U(e),e.dom.bounds());r&&eo(e,"a0",r)}e.dom.redraw()}function Hr(e,t){const o=e.dom.elements.board;if("ResizeObserver"in window&&new ResizeObserver(t).observe(e.dom.elements.wrap),(e.disableContextMenu||e.drawable.enabled)&&o.addEventListener("contextmenu",r=>r.preventDefault()),e.viewOnly)return;const n=Wr(e);o.addEventListener("touchstart",n,{passive:!1}),o.addEventListener("mousedown",n,{passive:!1})}function Kr(e,t){const o=[];if("ResizeObserver"in window||o.push(Te(document.body,"chessground.resize",t)),!e.viewOnly){const n=Eo(e,_r,fr),r=Eo(e,Sr,pr);for(const i of["touchmove","mousemove"])o.push(Te(document,i,n));for(const i of["touchend","mouseup"])o.push(Te(document,i,r));const s=()=>e.dom.bounds.clear();o.push(Te(document,"scroll",s,{capture:!0,passive:!0})),o.push(Te(window,"resize",s,{passive:!0}))}return()=>o.forEach(n=>n())}function Te(e,t,o,n){return e.addEventListener(t,o,n),()=>e.removeEventListener(t,o,n)}const Wr=e=>t=>{e.draggable.current?Ie(e):e.drawable.current?ho(e):t.shiftKey||Ht(t)?e.drawable.enabled&&hr(e,t):e.viewOnly||(e.dropmode.active?Vr(e,t):yr(e,t))},Eo=(e,t,o)=>n=>{e.drawable.current?e.drawable.enabled&&o(e,n):e.viewOnly||t(e,n)};function zr(e){const t=U(e),o=Ce(e.dom.bounds()),n=e.dom.elements.board,r=e.pieces,s=e.animation.current,i=s?s.plan.anims:new Map,a=s?s.plan.fadings:new Map,c=e.draggable.current,l=Qr(e),d=new Set,f=new Set,p=new Map,w=new Map;let u,m,g,v,y,k,A,T,q,B;for(m=n.firstChild;m;){if(u=m.cgKey,Co(m))if(g=r.get(u),y=i.get(u),k=a.get(u),v=m.cgPiece,m.cgDragging&&(!c||c.orig!==u)&&(m.classList.remove("dragging"),J(m,o(P(u),t)),m.cgDragging=!1),!k&&m.cgFading&&(m.cgFading=!1,m.classList.remove("fading")),g){if(y&&m.cgAnimating&&v===Pe(g)){const C=P(u);C[0]+=y[2],C[1]+=y[3],m.classList.add("anim"),J(m,o(C,t))}else m.cgAnimating&&(m.cgAnimating=!1,m.classList.remove("anim"),J(m,o(P(u),t)),e.addPieceZIndex&&(m.style.zIndex=bt(P(u),t)));v===Pe(g)&&(!k||!m.cgFading)?d.add(u):k&&v===Pe(k)?(m.classList.add("fading"),m.cgFading=!0):yt(p,v,m)}else yt(p,v,m);else if(To(m)){const C=m.className;l.get(u)===C?f.add(u):yt(w,C,m)}m=m.nextSibling}for(const[C,ce]of l)if(!f.has(C)){q=w.get(ce),B=q&&q.pop();const X=o(P(C),t);if(B)B.cgKey=C,J(B,X);else{const Z=Y("square",ce);Z.cgKey=C,J(Z,X),n.insertBefore(Z,n.firstChild)}}for(const[C,ce]of r)if(y=i.get(C),!d.has(C))if(A=p.get(Pe(ce)),T=A&&A.pop(),T){T.cgKey=C,T.cgFading&&(T.classList.remove("fading"),T.cgFading=!1);const X=P(C);e.addPieceZIndex&&(T.style.zIndex=bt(X,t)),y&&(T.cgAnimating=!0,T.classList.add("anim"),X[0]+=y[2],X[1]+=y[3]),J(T,o(X,t))}else{const X=Pe(ce),Z=Y("piece",X),Je=P(C);Z.cgPiece=X,Z.cgKey=C,y&&(Z.cgAnimating=!0,Je[0]+=y[2],Je[1]+=y[3]),J(Z,o(Je,t)),e.addPieceZIndex&&(Z.style.zIndex=bt(Je,t)),n.appendChild(Z)}for(const C of p.values())Po(e,C);for(const C of w.values())Po(e,C)}function Gr(e){const t=U(e),o=Ce(e.dom.bounds());let n=e.dom.elements.board.firstChild;for(;n;)(Co(n)&&!n.cgAnimating||To(n))&&J(n,o(P(n.cgKey),t)),n=n.nextSibling}function ko(e){var t,o;const n=e.dom.elements.wrap.getBoundingClientRect(),r=e.dom.elements.container,s=n.height/n.width,i=Math.floor(n.width*window.devicePixelRatio/8)*8/window.devicePixelRatio,a=i*s;r.style.width=i+"px",r.style.height=a+"px",e.dom.bounds.clear(),(t=e.addDimensionsCssVarsTo)===null||t===void 0||t.style.setProperty("--cg-width",i+"px"),(o=e.addDimensionsCssVarsTo)===null||o===void 0||o.style.setProperty("--cg-height",a+"px")}const Co=e=>e.tagName==="PIECE",To=e=>e.tagName==="SQUARE";function Po(e,t){for(const o of t)e.dom.elements.board.removeChild(o)}function bt(e,t){const o=e[1];return`${t?10-o:3+o}`}const Pe=e=>`${e.color} ${e.role}`;function Qr(e){var t,o,n;const r=new Map;if(e.lastMove&&e.highlight.lastMove)for(const a of e.lastMove)ee(r,a,"last-move");if(e.check&&e.highlight.check&&ee(r,e.check,"check"),e.selected&&(ee(r,e.selected,"selected"),e.movable.showDests)){const a=(t=e.movable.dests)===null||t===void 0?void 0:t.get(e.selected);if(a)for(const l of a)ee(r,l,"move-dest"+(e.pieces.has(l)?" oc":""));const c=(n=(o=e.premovable.customDests)===null||o===void 0?void 0:o.get(e.selected))!==null&&n!==void 0?n:e.premovable.dests;if(c)for(const l of c)ee(r,l,"premove-dest"+(e.pieces.has(l)?" oc":""))}const s=e.premovable.current;if(s)for(const a of s)ee(r,a,"current-premove");else e.predroppable.current&&ee(r,e.predroppable.current.key,"current-premove");const i=e.exploding;if(i)for(const a of i.keys)ee(r,a,"exploding"+i.stage);return e.highlight.custom&&e.highlight.custom.forEach((a,c)=>{ee(r,c,a)}),r}function ee(e,t,o){const n=e.get(t);n?e.set(t,`${n} ${o}`):e.set(t,o)}function yt(e,t,o){const n=e.get(t);n?n.push(o):e.set(t,[o])}function Jr(e,t,o){const n=new Map,r=[];for(const a of e)n.set(a.hash,!1);let s=t.firstElementChild,i;for(;s;)i=s.getAttribute("cgHash"),n.has(i)?n.set(i,!0):r.push(s),s=s.nextElementSibling;for(const a of r)t.removeChild(a);for(const a of e)n.get(a.hash)||t.appendChild(o(a))}function Xr(e,t){const o=e.drawable.autoShapes.filter(n=>n.piece).map(n=>({shape:n,hash:es(n),current:!1}));Jr(o,t,n=>Yr(e,n,e.dom.bounds()))}function Zr(e){var t;const o=U(e),n=Ce(e.dom.bounds());let r=(t=e.dom.elements.autoPieces)===null||t===void 0?void 0:t.firstChild;for(;r;)Vt(r,n(P(r.cgKey),o),r.cgScale),r=r.nextSibling}function Yr(e,{shape:t,hash:o},n){var r,s,i;const a=t.orig,c=(r=t.piece)===null||r===void 0?void 0:r.role,l=(s=t.piece)===null||s===void 0?void 0:s.color,d=(i=t.piece)===null||i===void 0?void 0:i.scale,f=Y("piece",`${c} ${l}`);return f.setAttribute("cgHash",o),f.cgKey=a,f.cgScale=d,Vt(f,Ce(n)(P(a),U(e)),d),f}const es=e=>{var t,o,n;return[e.orig,(t=e.piece)===null||t===void 0?void 0:t.role,(o=e.piece)===null||o===void 0?void 0:o.color,(n=e.piece)===null||n===void 0?void 0:n.scale].join(",")};function ts(e,t){const o=Cr();ao(o,{});function n(){const r="dom"in o?o.dom.unbind:void 0,s=jr(e,o),i=Un(()=>s.board.getBoundingClientRect()),a=d=>{zr(l),s.autoPieces&&Xr(l,s.autoPieces),!d&&s.svg&&Pr(l,s.svg,s.customSvg)},c=()=>{ko(l),Gr(l),s.autoPieces&&Zr(l)},l=o;return l.dom={elements:s,bounds:i,redraw:os(a),redrawNow:a,unbind:r},l.drawable.prevSvgHash="",ko(l),a(!1),Hr(l,c),r||(l.dom.unbind=Kr(l,c)),l.events.insert&&l.events.insert(s),l}return kr(n(),n)}function os(e){let t=!1;return()=>{t||(t=!0,requestAnimationFrame(()=>{e(),t=!1}))}}class ns{constructor(t,o,n,r){O(this,"game");O(this,"board");O(this,"boardState");O(this,"props");O(this,"emit");this.boardState=o,this.props=n,this.emit=r,this.game=new Mn,this.board=ts(t),this.resetBoard()}updateGameState({updateFen:t=!0}={}){this.boardState.historyViewerState.isEnabled||(t&&this.board.set({fen:this.game.fen()}),this.board.state.turnColor=this.getTurnColor(),this.board.state.movable.free?(this.board.state.movable.color="both",this.board.state.movable.dests=new Map):(this.board.state.movable.color=this.props.playerColor||this.board.state.turnColor,this.board.state.movable.dests=Ft(this.game)),this.displayInCheck(this.game.inCheck(),this.board.state.turnColor),this.boardState.showThreats&&this.drawMoves()),this.emitEvents()}displayInCheck(t,o){if(t){for(const[n,r]of this.board.state.pieces)if(r.role==="king"&&r.color===o){this.board.state.check=n;return}}else this.board.state.check=void 0}emitEvents(){this.game.inCheck()&&this.emit(this.game.isCheckmate()?"checkmate":"check",this.board.state.turnColor),this.game.isDraw()&&this.emit("draw"),this.game.isStalemate()&&this.emit("stalemate")}async changeTurn(t,o,n){let r;xn(o,this.game.get(t))&&(r=await new Promise(s=>{this.boardState.promotionDialogState={isEnabled:!0,color:this.getTurnColor(),callback:s}})),this.move({from:t,to:o,promotion:r})}resetBoard(){this.setConfig(this.props.boardConfig,!0)}undoLastMove(){const t=this.game.undo();if(t!=null&&(this.boardState.historyViewerState.isEnabled&&this.boardState.historyViewerState.plyViewing===this.getCurrentPlyNumber()&&this.stopViewingHistory(),!this.boardState.historyViewerState.isEnabled)){this.board.set({fen:t.before}),this.updateGameState({updateFen:!1});const o=this.getLastMove();this.board.state.lastMove=o?[o==null?void 0:o.from,o==null?void 0:o.to]:void 0}}getMaterialCount(){const t=this.board.state.pieces,o={pawn:1,knight:3,bishop:3,rook:5,queen:9,king:0},n={materialWhite:0,materialBlack:0,materialDiff:0};for(const r of t)r[1].color==="white"?n.materialWhite+=o[r[1].role]:n.materialBlack+=o[r[1].role];return n.materialDiff=n.materialWhite-n.materialBlack,n}getCapturedPieces(){const t={white:[],black:[]};for(const{color:o,captured:n}of this.getHistory(!0))n&&t[Be(o)].push(n);return t}toggleOrientation(){this.board.toggleOrientation()}drawMoves(){this.boardState.showThreats=!0,this.board.setShapes(Nn(this.game.moves({verbose:!0})))}hideMoves(){this.boardState.showThreats=!1,this.board.setShapes([])}drawMove(t,o,n){this.board.setShapes([{orig:t,dest:o,brush:n}])}toggleMoves(){this.boardState.showThreats?this.hideMoves():this.drawMoves()}async getOpeningName(){var t;try{const o=this.game.history({verbose:!0}).map(n=>n.lan).join(",");return((t=(await(await fetch(`https://explorer.lichess.ovh/masters?play=${o}`)).json()).opening)==null?void 0:t.name)??null}catch{return null}}move(t){let o;try{o=this.game.move(t)}catch{return typeof t=="object"&&this.board.state.movable.free&&(this.board.move(t.from,t.to),this.updateGameState({updateFen:!1})),!1}return this.emit("move",o),o!=null&&o.promotion&&this.emit("promotion",{color:Be(o.color),promotedTo:o.promotion.toUpperCase(),sanMove:o.san}),this.boardState.historyViewerState.isEnabled||(this.board.move(o.from,o.to),(o.flags==="e"||o!=null&&o.promotion)&&setTimeout(()=>this.board.set({fen:o.after}),this.board.state.animation.current?this.board.state.animation.duration:0),this.updateGameState({updateFen:!1}),b.nextTick(this.board.playPremove)),!0}getTurnColor(){return Be(this.game.turn())}getPossibleMoves(){return Ft(this.game)}getCurrentTurnNumber(){return this.game.moveNumber()}getCurrentPlyNumber(){return 2*this.getCurrentTurnNumber()-(this.getTurnColor()==="black"?1:2)}getLastMove(){return this.game.history({verbose:!0}).at(-1)}getHistory(t=!1){return this.game.history({verbose:t})}getFen(){return this.game.fen()}getBoardPosition(){return this.game.board()}getPgn(){return this.game.pgn()}getIsGameOver(){return this.game.isGameOver()}getIsCheckmate(){return this.game.isCheckmate()}getIsCheck(){return this.game.isCheck()}getIsStalemate(){return this.game.isStalemate()}getIsDraw(){return this.game.isDraw()}getIsThreefoldRepetition(){return this.game.isThreefoldRepetition()}getIsInsufficientMaterial(){return this.game.isInsufficientMaterial()}getSquareColor(t){return this.game.squareColor(t)}getSquare(t){return this.game.get(t)}setPosition(t){this.game.load(t),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState()}putPiece(t,o){if(this.board.state.movable.free){const n=this.board.state.pieces;return n.set(o,{color:t.color==="w"?"white":"black",role:Bn[t.type]}),this.board.setPieces(n),!0}else{const n=this.game.put(t,o);return n&&this.updateGameState(),n}}removePiece(t){this.board.state.pieces.delete(t),this.game.remove(t)}clearBoard(){this.game.clear(),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState()}setShapes(t){this.board.setShapes(t)}loadPgn(t){this.game.loadPgn(t),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState();const o=this.getLastMove();o&&this.board.set({lastMove:[o.from,o.to]})}getPgnInfo(){return this.game.header()}setPgnInfo(t){return this.game.header(...Object.entries(t).flat())}setConfig(t,o=!1){var s;if(o&&(t=Ut(Dn,t),this.board.state.selected=void 0),((s=t.movable)==null?void 0:s.events)&&"after"in t.movable.events){const i=t.movable.events.after;t.movable.events.after=i?async(...a)=>{await this.changeTurn(...a),i(...a)}:this.changeTurn.bind(this)}const{fen:n,...r}=t;this.board.set(r),n&&this.setPosition(n),this.board.redrawAll()}viewHistory(t){const o=this.getHistory(!0);if(t<0||t>o.length)return;const n=this.board.state.animation.enabled&&(this.boardState.historyViewerState.isEnabled&&Math.abs(this.boardState.historyViewerState.plyViewing-t)!==1||!this.boardState.historyViewerState.isEnabled&&t!==o.length-1);if(n&&this.board.set({animation:{enabled:!1}}),t<o.length)this.boardState.historyViewerState.isEnabled?this.boardState.historyViewerState.plyViewing=t:this.boardState.historyViewerState={isEnabled:!0,plyViewing:t,viewOnly:this.board.state.viewOnly},this.board.set({fen:o[t].before,viewOnly:!0,lastMove:t>0?[o[t-1].from,o[t-1].to]:void 0,selected:void 0}),this.displayInCheck(t>0?"+#".includes(o[t-1].san.at(-1)):!1,Be(o[t].color)),this.board.cancelPremove();else if(this.boardState.historyViewerState.isEnabled){const r=o.at(-1);this.board.set({fen:r.after,viewOnly:this.boardState.historyViewerState.viewOnly,lastMove:[r.from,r.to]}),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState({updateFen:!1})}n&&this.board.set({animation:{enabled:!0}})}stopViewingHistory(){this.boardState.historyViewerState.isEnabled&&this.viewHistory(this.getCurrentPlyNumber())}viewStart(){this.viewHistory(0)}viewNext(){this.boardState.historyViewerState.isEnabled&&this.viewHistory(this.boardState.historyViewerState.plyViewing+1)}viewPrevious(){const t=this.boardState.historyViewerState.isEnabled?this.boardState.historyViewerState.plyViewing:this.getCurrentPlyNumber();this.viewHistory(t-1)}}const rs={class:"main-board"},ss=b.defineComponent({__name:"TheChessboard",props:{boardConfig:{default:()=>({})},playerColor:{},reactiveConfig:{type:Boolean,default:!1}},emits:["boardCreated","check","checkmate","stalemate","draw","promotion","move"],setup(e,{emit:t}){const o=e,n=b.ref(null),r=b.reactive({showThreats:!1,promotionDialogState:{isEnabled:!1},historyViewerState:{isEnabled:!1}});return b.onMounted(()=>{if(n.value==null)throw new Error("vue3-chessboard: Failed to mount board.");const s=new ns(n.value,r,o,t);if(t("boardCreated",s),o.reactiveConfig){let i=Le(o.boardConfig);b.watch(b.reactive(o.boardConfig),a=>{s.setConfig($t(i,a)),i=Le(a)})}}),(s,i)=>(b.openBlock(),b.createElementBlock("section",{class:b.normalizeClass(["main-wrap",{disabledBoard:r.promotionDialogState.isEnabled,viewingHistory:r.historyViewerState.isEnabled}])},[b.createElementVNode("div",rs,[r.promotionDialogState.isEnabled?(b.openBlock(),b.createBlock(gn,{key:0,state:r.promotionDialogState,onPromotionSelected:i[0]||(i[0]=a=>r.promotionDialogState={isEnabled:!1})},null,8,["state"])):b.createCommentVNode("",!0),b.createElementVNode("div",{ref_key:"boardElement",ref:n},null,512)])],2))}}),Fe=(e,t)=>{const o=e.__vccOpts||e;for(const[n,r]of t)o[n]=r;return o},is={props:{initialTime:{type:Number,required:!0}},data(){return{timeLeft:this.initialTime,timer:null}},computed:{formattedTime(){const e=Math.floor(this.timeLeft/60),t=this.timeLeft%60;return`${e}:${t<10?"0":""}${t}`}},beforeUnmount(){this.clearTimer()},methods:{startTimer(){this.timeLeft=this.initialTime,this.resumeTimer()},resumeTimer(){this.timer=setInterval(()=>{this.timeLeft>0?this.timeLeft-=1:(this.clearTimer(),this.$emit("time-up"))},1e3)},pauseTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)},clearTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)}}};function as(e,t,o,n,r,s){return b.openBlock(),b.createElementBlock("div",null,b.toDisplayString(s.formattedTime),1)}const cs=Fe(is,[["render",as],["__scopeId","data-v-3770351d"]]);class ls{constructor(t,o=""){O(this,"stockfish");O(this,"boardApi");O(this,"bestMove");O(this,"engineName");this.boardApi=t;const n=typeof WebAssembly=="object"&&WebAssembly.validate(Uint8Array.of(0,97,115,109,1,0,0,0));this.stockfish=new Worker(n?`${o}/stockfish.wasm.js`:`${o}/stockfish.js`),this.setupListeners(),this.stockfish.postMessage("uci")}setupListeners(){this.stockfish.addEventListener("message",t=>this.handleEngineStdout(t)),this.stockfish.addEventListener("error",t=>console.error(t)),this.stockfish.addEventListener("messageerror",t=>console.error(t))}handleEngineStdout(t){const o=t.data.split(" ");if(o[0]==="uciok"){this.setOption("UCI_AnalyseMode","true"),this.setOption("Analysis Contempt","Off"),this.stockfish.postMessage("ucinewgame"),this.stockfish.postMessage("isready");return}if(o[0]==="readyok"){this.stockfish.postMessage("go movetime 1200");return}o[0]==="bestmove"&&o[1]&&o[1]!==this.bestMove&&(this.bestMove=o[1],this.boardApi.getTurnColor()==="black"&&this.boardApi.move({from:this.bestMove.slice(0,2),to:this.bestMove.slice(2,4)}))}setOption(t,o){this.stockfish.postMessage(`setoption name ${t} value ${o}`)}sendPosition(t){this.stockfish.postMessage(`position startpos moves ${t}`);const o=this.boardApi.getTurnColor()==="black"?7500:1200;this.stockfish.postMessage(`go movetime ${o}`)}}const ds={components:{TheChessboard:ss,Timer:cs},props:{handleMove:Function},inject:["playerProfiles","baseUrl"],data(){return{engine:null,showSupportLine:!1,inTimeout:!1,currentPlayer:"white",boardAPI:null,boardConfig:{}}},created(){this.boardConfig={events:{select:async()=>{var e,t;(e=this.engine)!=null&&e.bestMove&&this.currentPlayer==="white"&&this.showSupportLine&&((t=this.boardAPI)==null||t.drawMove(this.engine.bestMove.slice(0,2),this.engine.bestMove.slice(2,4),"paleBlue"))},move:()=>{var e;(e=this.boardAPI)==null||e.hideMoves()}},autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!0,blockTouchScroll:!0}},methods:{handleBoardCreated(e){this.boardAPI=e,this.engine=new ls(e,this.baseUrl||window.location.origin)},handleTimeUp(e){console.log(`${e} time is up!`)},callTimeout(e){this.$refs.whiteTimer.pauseTimer(),this.$refs.blackTimer.pauseTimer(),this.$refs.timeoutTimer.startTimer(),this.inTimeout=!0,this.boardConfig.viewOnly=!0},handleTimeoutOver(){this.currentPlayer=="white"?this.$refs.whiteTimer.resumeTimer():this.$refs.blackTimer.resumeTimer(),this.inTimeout=!1,this.boardConfig.viewOnly=!1},startBlackTimer(){this.currentPlayer="black",this.$refs.blackTimer.resumeTimer(),this.$refs.whiteTimer.pauseTimer()},startWhiteTimer(){this.currentPlayer="white",this.$refs.whiteTimer.resumeTimer(),this.$refs.blackTimer.pauseTimer()}}},us={class:"game-loadout game-loadout-mobile"},hs={class:"profile"},fs={class:"avatar"},ps=["src"],ms=["innerHTML"],gs={class:"profile"},bs={class:"avatar"},ys=["src"],ws=["innerHTML"],vs={class:"chessboard-wrap"},_s={class:"text"};function Ss(e,t,o,n,r,s){const i=b.resolveComponent("TheChessboard"),a=b.resolveComponent("Timer");return b.openBlock(),b.createElementBlock("div",null,[b.createElementVNode("div",us,[b.createElementVNode("div",{id:"player2-profile",class:b.normalizeClass(["pprofile",r.currentPlayer==="black"?"in-move":""])},[b.createElementVNode("div",hs,[b.createElementVNode("div",fs,[b.createElementVNode("img",{src:s.playerProfiles.player2.avatar},null,8,ps)]),b.createElementVNode("div",{class:"player-name",innerHTML:s.playerProfiles.player2.name},null,8,ms)])],2),t[5]||(t[5]=b.createElementVNode("div",{id:"game-field"},null,-1)),b.createElementVNode("div",{id:"player1-profile",class:b.normalizeClass(["pprofile",r.currentPlayer==="white"?"in-move":""])},[b.createElementVNode("div",gs,[b.createElementVNode("div",bs,[b.createElementVNode("img",{src:s.playerProfiles.player1.avatar},null,8,ys)]),b.createElementVNode("div",{class:"player-name",innerHTML:s.playerProfiles.player1.name},null,8,ws)])],2)]),(b.openBlock(),b.createBlock(b.Teleport,{to:"#game-field",defer:""},[b.createElementVNode("div",vs,[b.createVNode(i,{ref:"chessboard",onBoardCreated:s.handleBoardCreated,onMove:o.handleMove,"board-config":r.boardConfig,"player-color":"white"},null,8,["onBoardCreated","onMove","board-config"]),b.createElementVNode("div",{class:"chessboard-overlay",style:b.normalizeStyle(`display: ${r.inTimeout?"block":"none"}`)},[b.createElementVNode("div",_s,[b.createTextVNode(b.toDisplayString(r.currentPlayer)+" call timeout ",1),b.createVNode(a,{ref:"timeoutTimer",initialTime:60,onTimeUp:t[0]||(t[0]=c=>s.handleTimeoutOver())},null,512)])],4)])])),(b.openBlock(),b.createBlock(b.Teleport,{to:"#player1-profile",defer:""},[b.createVNode(a,{ref:"whiteTimer",initialTime:600,onTimeUp:t[1]||(t[1]=c=>s.handleTimeUp("white"))},null,512),r.currentPlayer=="white"?(b.openBlock(),b.createElementBlock("button",{key:0,onClick:t[2]||(t[2]=c=>s.callTimeout(r.currentPlayer))}," Call Timeout ")):b.createCommentVNode("",!0),b.createElementVNode("label",null,[b.withDirectives(b.createElementVNode("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=c=>r.showSupportLine=c)},null,512),[[b.vModelCheckbox,r.showSupportLine]]),t[6]||(t[6]=b.createTextVNode(" Show Support Line "))])])),(b.openBlock(),b.createBlock(b.Teleport,{to:"#player2-profile",defer:""},[b.createVNode(a,{ref:"blackTimer",initialTime:600,onTimeUp:t[4]||(t[4]=c=>s.handleTimeUp("black"))},null,512)]))])}const Ue=Fe(ds,[["render",Ss],["__scopeId","data-v-64f502be"]]);function Ao(e,t){return function(){return e.apply(t,arguments)}}const{toString:Es}=Object.prototype,{getPrototypeOf:wt}=Object,$e=(e=>t=>{const o=Es.call(t);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),Q=e=>(e=e.toLowerCase(),t=>$e(t)===e),je=e=>t=>typeof t===e,{isArray:ye}=Array,Ae=je("undefined");function ks(e){return e!==null&&!Ae(e)&&e.constructor!==null&&!Ae(e.constructor)&&K(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Ro=Q("ArrayBuffer");function Cs(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Ro(e.buffer),t}const Ts=je("string"),K=je("function"),Oo=je("number"),Ve=e=>e!==null&&typeof e=="object",Ps=e=>e===!0||e===!1,He=e=>{if($e(e)!=="object")return!1;const t=wt(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},As=Q("Date"),Rs=Q("File"),Os=Q("Blob"),Ms=Q("FileList"),Ns=e=>Ve(e)&&K(e.pipe),xs=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||K(e.append)&&((t=$e(e))==="formdata"||t==="object"&&K(e.toString)&&e.toString()==="[object FormData]"))},Bs=Q("URLSearchParams"),[Ls,Is,Ds,qs]=["ReadableStream","Request","Response","Headers"].map(Q),Fs=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Re(e,t,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let n,r;if(typeof e!="object"&&(e=[e]),ye(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{const s=o?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let a;for(n=0;n<i;n++)a=s[n],t.call(null,e[a],a,e)}}function Mo(e,t){t=t.toLowerCase();const o=Object.keys(e);let n=o.length,r;for(;n-- >0;)if(r=o[n],t===r.toLowerCase())return r;return null}const pe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,No=e=>!Ae(e)&&e!==pe;function vt(){const{caseless:e}=No(this)&&this||{},t={},o=(n,r)=>{const s=e&&Mo(t,r)||r;He(t[s])&&He(n)?t[s]=vt(t[s],n):He(n)?t[s]=vt({},n):ye(n)?t[s]=n.slice():t[s]=n};for(let n=0,r=arguments.length;n<r;n++)arguments[n]&&Re(arguments[n],o);return t}const Us=(e,t,o,{allOwnKeys:n}={})=>(Re(t,(r,s)=>{o&&K(r)?e[s]=Ao(r,o):e[s]=r},{allOwnKeys:n}),e),$s=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),js=(e,t,o,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},Vs=(e,t,o,n)=>{let r,s,i;const a={};if(t=t||{},e==null)return t;do{for(r=Object.getOwnPropertyNames(e),s=r.length;s-- >0;)i=r[s],(!n||n(i,e,t))&&!a[i]&&(t[i]=e[i],a[i]=!0);e=o!==!1&&wt(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},Hs=(e,t,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=t.length;const n=e.indexOf(t,o);return n!==-1&&n===o},Ks=e=>{if(!e)return null;if(ye(e))return e;let t=e.length;if(!Oo(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},Ws=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&wt(Uint8Array)),zs=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const s=r.value;t.call(e,s[0],s[1])}},Gs=(e,t)=>{let o;const n=[];for(;(o=e.exec(t))!==null;)n.push(o);return n},Qs=Q("HTMLFormElement"),Js=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,n,r){return n.toUpperCase()+r}),xo=(({hasOwnProperty:e})=>(t,o)=>e.call(t,o))(Object.prototype),Xs=Q("RegExp"),Bo=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),n={};Re(o,(r,s)=>{let i;(i=t(r,s,e))!==!1&&(n[s]=i||r)}),Object.defineProperties(e,n)},Zs=e=>{Bo(e,(t,o)=>{if(K(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const n=e[o];if(K(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},Ys=(e,t)=>{const o={},n=r=>{r.forEach(s=>{o[s]=!0})};return ye(e)?n(e):n(String(e).split(t)),o},ei=()=>{},ti=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,_t="abcdefghijklmnopqrstuvwxyz",Lo="0123456789",Io={DIGIT:Lo,ALPHA:_t,ALPHA_DIGIT:_t+_t.toUpperCase()+Lo},oi=(e=16,t=Io.ALPHA_DIGIT)=>{let o="";const{length:n}=t;for(;e--;)o+=t[Math.random()*n|0];return o};function ni(e){return!!(e&&K(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const ri=e=>{const t=new Array(10),o=(n,r)=>{if(Ve(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[r]=n;const s=ye(n)?[]:{};return Re(n,(i,a)=>{const c=o(i,r+1);!Ae(c)&&(s[a]=c)}),t[r]=void 0,s}}return n};return o(e,0)},si=Q("AsyncFunction"),ii=e=>e&&(Ve(e)||K(e))&&K(e.then)&&K(e.catch),Do=((e,t)=>e?setImmediate:t?((o,n)=>(pe.addEventListener("message",({source:r,data:s})=>{r===pe&&s===o&&n.length&&n.shift()()},!1),r=>{n.push(r),pe.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",K(pe.postMessage)),ai=typeof queueMicrotask<"u"?queueMicrotask.bind(pe):typeof process<"u"&&process.nextTick||Do,h={isArray:ye,isArrayBuffer:Ro,isBuffer:ks,isFormData:xs,isArrayBufferView:Cs,isString:Ts,isNumber:Oo,isBoolean:Ps,isObject:Ve,isPlainObject:He,isReadableStream:Ls,isRequest:Is,isResponse:Ds,isHeaders:qs,isUndefined:Ae,isDate:As,isFile:Rs,isBlob:Os,isRegExp:Xs,isFunction:K,isStream:Ns,isURLSearchParams:Bs,isTypedArray:Ws,isFileList:Ms,forEach:Re,merge:vt,extend:Us,trim:Fs,stripBOM:$s,inherits:js,toFlatObject:Vs,kindOf:$e,kindOfTest:Q,endsWith:Hs,toArray:Ks,forEachEntry:zs,matchAll:Gs,isHTMLForm:Qs,hasOwnProperty:xo,hasOwnProp:xo,reduceDescriptors:Bo,freezeMethods:Zs,toObjectSet:Ys,toCamelCase:Js,noop:ei,toFiniteNumber:ti,findKey:Mo,global:pe,isContextDefined:No,ALPHABET:Io,generateString:oi,isSpecCompliantForm:ni,toJSONObject:ri,isAsyncFn:si,isThenable:ii,setImmediate:Do,asap:ai};function E(e,t,o,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}h.inherits(E,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:h.toJSONObject(this.config),code:this.code,status:this.status}}});const qo=E.prototype,Fo={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Fo[e]={value:e}}),Object.defineProperties(E,Fo),Object.defineProperty(qo,"isAxiosError",{value:!0}),E.from=(e,t,o,n,r,s)=>{const i=Object.create(qo);return h.toFlatObject(e,i,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),E.call(i,e.message,t,o,n,r),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const ci=null;function St(e){return h.isPlainObject(e)||h.isArray(e)}function Uo(e){return h.endsWith(e,"[]")?e.slice(0,-2):e}function $o(e,t,o){return e?e.concat(t).map(function(r,s){return r=Uo(r),!o&&s?"["+r+"]":r}).join(o?".":""):t}function li(e){return h.isArray(e)&&!e.some(St)}const di=h.toFlatObject(h,{},null,function(t){return/^is[A-Z]/.test(t)});function Ke(e,t,o){if(!h.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,o=h.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!h.isUndefined(g[m])});const n=o.metaTokens,r=o.visitor||d,s=o.dots,i=o.indexes,c=(o.Blob||typeof Blob<"u"&&Blob)&&h.isSpecCompliantForm(t);if(!h.isFunction(r))throw new TypeError("visitor must be a function");function l(u){if(u===null)return"";if(h.isDate(u))return u.toISOString();if(!c&&h.isBlob(u))throw new E("Blob is not supported. Use a Buffer instead.");return h.isArrayBuffer(u)||h.isTypedArray(u)?c&&typeof Blob=="function"?new Blob([u]):Buffer.from(u):u}function d(u,m,g){let v=u;if(u&&!g&&typeof u=="object"){if(h.endsWith(m,"{}"))m=n?m:m.slice(0,-2),u=JSON.stringify(u);else if(h.isArray(u)&&li(u)||(h.isFileList(u)||h.endsWith(m,"[]"))&&(v=h.toArray(u)))return m=Uo(m),v.forEach(function(k,A){!(h.isUndefined(k)||k===null)&&t.append(i===!0?$o([m],A,s):i===null?m:m+"[]",l(k))}),!1}return St(u)?!0:(t.append($o(g,m,s),l(u)),!1)}const f=[],p=Object.assign(di,{defaultVisitor:d,convertValue:l,isVisitable:St});function w(u,m){if(!h.isUndefined(u)){if(f.indexOf(u)!==-1)throw Error("Circular reference detected in "+m.join("."));f.push(u),h.forEach(u,function(v,y){(!(h.isUndefined(v)||v===null)&&r.call(t,v,h.isString(y)?y.trim():y,m,p))===!0&&w(v,m?m.concat(y):[y])}),f.pop()}}if(!h.isObject(e))throw new TypeError("data must be an object");return w(e),t}function jo(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Et(e,t){this._pairs=[],e&&Ke(e,this,t)}const Vo=Et.prototype;Vo.append=function(t,o){this._pairs.push([t,o])},Vo.toString=function(t){const o=t?function(n){return t.call(this,n,jo)}:jo;return this._pairs.map(function(r){return o(r[0])+"="+o(r[1])},"").join("&")};function ui(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ho(e,t,o){if(!t)return e;const n=o&&o.encode||ui,r=o&&o.serialize;let s;if(r?s=r(t,o):s=h.isURLSearchParams(t)?t.toString():new Et(t,o).toString(n),s){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class Ko{constructor(){this.handlers=[]}use(t,o,n){return this.handlers.push({fulfilled:t,rejected:o,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){h.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Wo={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hi={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:Et,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},kt=typeof window<"u"&&typeof document<"u",Ct=typeof navigator=="object"&&navigator||void 0,fi=kt&&(!Ct||["ReactNative","NativeScript","NS"].indexOf(Ct.product)<0),pi=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",mi=kt&&window.location.href||"http://localhost",$={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:kt,hasStandardBrowserEnv:fi,hasStandardBrowserWebWorkerEnv:pi,navigator:Ct,origin:mi},Symbol.toStringTag,{value:"Module"})),...hi};function gi(e,t){return Ke(e,new $.classes.URLSearchParams,Object.assign({visitor:function(o,n,r,s){return $.isNode&&h.isBuffer(o)?(this.append(n,o.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function bi(e){return h.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function yi(e){const t={},o=Object.keys(e);let n;const r=o.length;let s;for(n=0;n<r;n++)s=o[n],t[s]=e[s];return t}function zo(e){function t(o,n,r,s){let i=o[s++];if(i==="__proto__")return!0;const a=Number.isFinite(+i),c=s>=o.length;return i=!i&&h.isArray(r)?r.length:i,c?(h.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!a):((!r[i]||!h.isObject(r[i]))&&(r[i]=[]),t(o,n,r[i],s)&&h.isArray(r[i])&&(r[i]=yi(r[i])),!a)}if(h.isFormData(e)&&h.isFunction(e.entries)){const o={};return h.forEachEntry(e,(n,r)=>{t(bi(n),r,o,0)}),o}return null}function wi(e,t,o){if(h.isString(e))try{return(t||JSON.parse)(e),h.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(e)}const Oe={transitional:Wo,adapter:["xhr","http","fetch"],transformRequest:[function(t,o){const n=o.getContentType()||"",r=n.indexOf("application/json")>-1,s=h.isObject(t);if(s&&h.isHTMLForm(t)&&(t=new FormData(t)),h.isFormData(t))return r?JSON.stringify(zo(t)):t;if(h.isArrayBuffer(t)||h.isBuffer(t)||h.isStream(t)||h.isFile(t)||h.isBlob(t)||h.isReadableStream(t))return t;if(h.isArrayBufferView(t))return t.buffer;if(h.isURLSearchParams(t))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return gi(t,this.formSerializer).toString();if((a=h.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Ke(a?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||r?(o.setContentType("application/json",!1),wi(t)):t}],transformResponse:[function(t){const o=this.transitional||Oe.transitional,n=o&&o.forcedJSONParsing,r=this.responseType==="json";if(h.isResponse(t)||h.isReadableStream(t))return t;if(t&&h.isString(t)&&(n&&!this.responseType||r)){const i=!(o&&o.silentJSONParsing)&&r;try{return JSON.parse(t)}catch(a){if(i)throw a.name==="SyntaxError"?E.from(a,E.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:$.classes.FormData,Blob:$.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};h.forEach(["delete","get","head","post","put","patch"],e=>{Oe.headers[e]={}});const vi=h.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),_i=e=>{const t={};let o,n,r;return e&&e.split(`
`).forEach(function(i){r=i.indexOf(":"),o=i.substring(0,r).trim().toLowerCase(),n=i.substring(r+1).trim(),!(!o||t[o]&&vi[o])&&(o==="set-cookie"?t[o]?t[o].push(n):t[o]=[n]:t[o]=t[o]?t[o]+", "+n:n)}),t},Go=Symbol("internals");function Me(e){return e&&String(e).trim().toLowerCase()}function We(e){return e===!1||e==null?e:h.isArray(e)?e.map(We):String(e)}function Si(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=o.exec(e);)t[n[1]]=n[2];return t}const Ei=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Tt(e,t,o,n,r){if(h.isFunction(n))return n.call(this,t,o);if(r&&(t=o),!!h.isString(t)){if(h.isString(n))return t.indexOf(n)!==-1;if(h.isRegExp(n))return n.test(t)}}function ki(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,o,n)=>o.toUpperCase()+n)}function Ci(e,t){const o=h.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+o,{value:function(r,s,i){return this[n].call(this,t,r,s,i)},configurable:!0})})}class j{constructor(t){t&&this.set(t)}set(t,o,n){const r=this;function s(a,c,l){const d=Me(c);if(!d)throw new Error("header name must be a non-empty string");const f=h.findKey(r,d);(!f||r[f]===void 0||l===!0||l===void 0&&r[f]!==!1)&&(r[f||c]=We(a))}const i=(a,c)=>h.forEach(a,(l,d)=>s(l,d,c));if(h.isPlainObject(t)||t instanceof this.constructor)i(t,o);else if(h.isString(t)&&(t=t.trim())&&!Ei(t))i(_i(t),o);else if(h.isHeaders(t))for(const[a,c]of t.entries())s(c,a,n);else t!=null&&s(o,t,n);return this}get(t,o){if(t=Me(t),t){const n=h.findKey(this,t);if(n){const r=this[n];if(!o)return r;if(o===!0)return Si(r);if(h.isFunction(o))return o.call(this,r,n);if(h.isRegExp(o))return o.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,o){if(t=Me(t),t){const n=h.findKey(this,t);return!!(n&&this[n]!==void 0&&(!o||Tt(this,this[n],n,o)))}return!1}delete(t,o){const n=this;let r=!1;function s(i){if(i=Me(i),i){const a=h.findKey(n,i);a&&(!o||Tt(n,n[a],a,o))&&(delete n[a],r=!0)}}return h.isArray(t)?t.forEach(s):s(t),r}clear(t){const o=Object.keys(this);let n=o.length,r=!1;for(;n--;){const s=o[n];(!t||Tt(this,this[s],s,t,!0))&&(delete this[s],r=!0)}return r}normalize(t){const o=this,n={};return h.forEach(this,(r,s)=>{const i=h.findKey(n,s);if(i){o[i]=We(r),delete o[s];return}const a=t?ki(s):String(s).trim();a!==s&&delete o[s],o[a]=We(r),n[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const o=Object.create(null);return h.forEach(this,(n,r)=>{n!=null&&n!==!1&&(o[r]=t&&h.isArray(n)?n.join(", "):n)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,o])=>t+": "+o).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...o){const n=new this(t);return o.forEach(r=>n.set(r)),n}static accessor(t){const n=(this[Go]=this[Go]={accessors:{}}).accessors,r=this.prototype;function s(i){const a=Me(i);n[a]||(Ci(r,i),n[a]=!0)}return h.isArray(t)?t.forEach(s):s(t),this}}j.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),h.reduceDescriptors(j.prototype,({value:e},t)=>{let o=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[o]=n}}}),h.freezeMethods(j);function Pt(e,t){const o=this||Oe,n=t||o,r=j.from(n.headers);let s=n.data;return h.forEach(e,function(a){s=a.call(o,s,r.normalize(),t?t.status:void 0)}),r.normalize(),s}function Qo(e){return!!(e&&e.__CANCEL__)}function we(e,t,o){E.call(this,e??"canceled",E.ERR_CANCELED,t,o),this.name="CanceledError"}h.inherits(we,E,{__CANCEL__:!0});function Jo(e,t,o){const n=o.config.validateStatus;!o.status||!n||n(o.status)?e(o):t(new E("Request failed with status code "+o.status,[E.ERR_BAD_REQUEST,E.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function Ti(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Pi(e,t){e=e||10;const o=new Array(e),n=new Array(e);let r=0,s=0,i;return t=t!==void 0?t:1e3,function(c){const l=Date.now(),d=n[s];i||(i=l),o[r]=c,n[r]=l;let f=s,p=0;for(;f!==r;)p+=o[f++],f=f%e;if(r=(r+1)%e,r===s&&(s=(s+1)%e),l-i<t)return;const w=d&&l-d;return w?Math.round(p*1e3/w):void 0}}function Ai(e,t){let o=0,n=1e3/t,r,s;const i=(l,d=Date.now())=>{o=d,r=null,s&&(clearTimeout(s),s=null),e.apply(null,l)};return[(...l)=>{const d=Date.now(),f=d-o;f>=n?i(l,d):(r=l,s||(s=setTimeout(()=>{s=null,i(r)},n-f)))},()=>r&&i(r)]}const ze=(e,t,o=3)=>{let n=0;const r=Pi(50,250);return Ai(s=>{const i=s.loaded,a=s.lengthComputable?s.total:void 0,c=i-n,l=r(c),d=i<=a;n=i;const f={loaded:i,total:a,progress:a?i/a:void 0,bytes:c,rate:l||void 0,estimated:l&&a&&d?(a-i)/l:void 0,event:s,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(f)},o)},Xo=(e,t)=>{const o=e!=null;return[n=>t[0]({lengthComputable:o,total:e,loaded:n}),t[1]]},Zo=e=>(...t)=>h.asap(()=>e(...t)),Ri=$.hasStandardBrowserEnv?function(){const t=$.navigator&&/(msie|trident)/i.test($.navigator.userAgent),o=document.createElement("a");let n;function r(s){let i=s;return t&&(o.setAttribute("href",i),i=o.href),o.setAttribute("href",i),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:o.pathname.charAt(0)==="/"?o.pathname:"/"+o.pathname}}return n=r(window.location.href),function(i){const a=h.isString(i)?r(i):i;return a.protocol===n.protocol&&a.host===n.host}}():function(){return function(){return!0}}(),Oi=$.hasStandardBrowserEnv?{write(e,t,o,n,r,s){const i=[e+"="+encodeURIComponent(t)];h.isNumber(o)&&i.push("expires="+new Date(o).toGMTString()),h.isString(n)&&i.push("path="+n),h.isString(r)&&i.push("domain="+r),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Mi(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Ni(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Yo(e,t){return e&&!Mi(t)?Ni(e,t):t}const en=e=>e instanceof j?{...e}:e;function me(e,t){t=t||{};const o={};function n(l,d,f){return h.isPlainObject(l)&&h.isPlainObject(d)?h.merge.call({caseless:f},l,d):h.isPlainObject(d)?h.merge({},d):h.isArray(d)?d.slice():d}function r(l,d,f){if(h.isUndefined(d)){if(!h.isUndefined(l))return n(void 0,l,f)}else return n(l,d,f)}function s(l,d){if(!h.isUndefined(d))return n(void 0,d)}function i(l,d){if(h.isUndefined(d)){if(!h.isUndefined(l))return n(void 0,l)}else return n(void 0,d)}function a(l,d,f){if(f in t)return n(l,d);if(f in e)return n(void 0,l)}const c={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(l,d)=>r(en(l),en(d),!0)};return h.forEach(Object.keys(Object.assign({},e,t)),function(d){const f=c[d]||r,p=f(e[d],t[d],d);h.isUndefined(p)&&f!==a||(o[d]=p)}),o}const tn=e=>{const t=me({},e);let{data:o,withXSRFToken:n,xsrfHeaderName:r,xsrfCookieName:s,headers:i,auth:a}=t;t.headers=i=j.from(i),t.url=Ho(Yo(t.baseURL,t.url),e.params,e.paramsSerializer),a&&i.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let c;if(h.isFormData(o)){if($.hasStandardBrowserEnv||$.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[l,...d]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];i.setContentType([l||"multipart/form-data",...d].join("; "))}}if($.hasStandardBrowserEnv&&(n&&h.isFunction(n)&&(n=n(t)),n||n!==!1&&Ri(t.url))){const l=r&&s&&Oi.read(s);l&&i.set(r,l)}return t},xi=typeof XMLHttpRequest<"u"&&function(e){return new Promise(function(o,n){const r=tn(e);let s=r.data;const i=j.from(r.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:l}=r,d,f,p,w,u;function m(){w&&w(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(d),r.signal&&r.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(r.method.toUpperCase(),r.url,!0),g.timeout=r.timeout;function v(){if(!g)return;const k=j.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),T={data:!a||a==="text"||a==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:k,config:e,request:g};Jo(function(B){o(B),m()},function(B){n(B),m()},T),g=null}"onloadend"in g?g.onloadend=v:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(v)},g.onabort=function(){g&&(n(new E("Request aborted",E.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new E("Network Error",E.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let A=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const T=r.transitional||Wo;r.timeoutErrorMessage&&(A=r.timeoutErrorMessage),n(new E(A,T.clarifyTimeoutError?E.ETIMEDOUT:E.ECONNABORTED,e,g)),g=null},s===void 0&&i.setContentType(null),"setRequestHeader"in g&&h.forEach(i.toJSON(),function(A,T){g.setRequestHeader(T,A)}),h.isUndefined(r.withCredentials)||(g.withCredentials=!!r.withCredentials),a&&a!=="json"&&(g.responseType=r.responseType),l&&([p,u]=ze(l,!0),g.addEventListener("progress",p)),c&&g.upload&&([f,w]=ze(c),g.upload.addEventListener("progress",f),g.upload.addEventListener("loadend",w)),(r.cancelToken||r.signal)&&(d=k=>{g&&(n(!k||k.type?new we(null,e,g):k),g.abort(),g=null)},r.cancelToken&&r.cancelToken.subscribe(d),r.signal&&(r.signal.aborted?d():r.signal.addEventListener("abort",d)));const y=Ti(r.url);if(y&&$.protocols.indexOf(y)===-1){n(new E("Unsupported protocol "+y+":",E.ERR_BAD_REQUEST,e));return}g.send(s||null)})},Bi=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let n=new AbortController,r;const s=function(l){if(!r){r=!0,a();const d=l instanceof Error?l:this.reason;n.abort(d instanceof E?d:new we(d instanceof Error?d.message:d))}};let i=t&&setTimeout(()=>{i=null,s(new E(`timeout ${t} of ms exceeded`,E.ETIMEDOUT))},t);const a=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(s):l.removeEventListener("abort",s)}),e=null)};e.forEach(l=>l.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>h.asap(a),c}},Li=function*(e,t){let o=e.byteLength;if(o<t){yield e;return}let n=0,r;for(;n<o;)r=n+t,yield e.slice(n,r),n=r},Ii=async function*(e,t){for await(const o of Di(e))yield*Li(o,t)},Di=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:o,value:n}=await t.read();if(o)break;yield n}}finally{await t.cancel()}},on=(e,t,o,n)=>{const r=Ii(e,t);let s=0,i,a=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:l,value:d}=await r.next();if(l){a(),c.close();return}let f=d.byteLength;if(o){let p=s+=f;o(p)}c.enqueue(new Uint8Array(d))}catch(l){throw a(l),l}},cancel(c){return a(c),r.return()}},{highWaterMark:2})},Ge=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",nn=Ge&&typeof ReadableStream=="function",qi=Ge&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),rn=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Fi=nn&&rn(()=>{let e=!1;const t=new Request($.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),sn=64*1024,At=nn&&rn(()=>h.isReadableStream(new Response("").body)),Qe={stream:At&&(e=>e.body)};Ge&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Qe[t]&&(Qe[t]=h.isFunction(e[t])?o=>o[t]():(o,n)=>{throw new E(`Response type '${t}' is not supported`,E.ERR_NOT_SUPPORT,n)})})})(new Response);const Ui=async e=>{if(e==null)return 0;if(h.isBlob(e))return e.size;if(h.isSpecCompliantForm(e))return(await new Request($.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(h.isArrayBufferView(e)||h.isArrayBuffer(e))return e.byteLength;if(h.isURLSearchParams(e)&&(e=e+""),h.isString(e))return(await qi(e)).byteLength},$i=async(e,t)=>{const o=h.toFiniteNumber(e.getContentLength());return o??Ui(t)},Rt={http:ci,xhr:xi,fetch:Ge&&(async e=>{let{url:t,method:o,data:n,signal:r,cancelToken:s,timeout:i,onDownloadProgress:a,onUploadProgress:c,responseType:l,headers:d,withCredentials:f="same-origin",fetchOptions:p}=tn(e);l=l?(l+"").toLowerCase():"text";let w=Bi([r,s&&s.toAbortSignal()],i),u;const m=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let g;try{if(c&&Fi&&o!=="get"&&o!=="head"&&(g=await $i(d,n))!==0){let T=new Request(t,{method:"POST",body:n,duplex:"half"}),q;if(h.isFormData(n)&&(q=T.headers.get("content-type"))&&d.setContentType(q),T.body){const[B,C]=Xo(g,ze(Zo(c)));n=on(T.body,sn,B,C)}}h.isString(f)||(f=f?"include":"omit");const v="credentials"in Request.prototype;u=new Request(t,{...p,signal:w,method:o.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:v?f:void 0});let y=await fetch(u);const k=At&&(l==="stream"||l==="response");if(At&&(a||k&&m)){const T={};["status","statusText","headers"].forEach(ce=>{T[ce]=y[ce]});const q=h.toFiniteNumber(y.headers.get("content-length")),[B,C]=a&&Xo(q,ze(Zo(a),!0))||[];y=new Response(on(y.body,sn,B,()=>{C&&C(),m&&m()}),T)}l=l||"text";let A=await Qe[h.findKey(Qe,l)||"text"](y,e);return!k&&m&&m(),await new Promise((T,q)=>{Jo(T,q,{data:A,headers:j.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:u})})}catch(v){throw m&&m(),v&&v.name==="TypeError"&&/fetch/i.test(v.message)?Object.assign(new E("Network Error",E.ERR_NETWORK,e,u),{cause:v.cause||v}):E.from(v,v&&v.code,e,u)}})};h.forEach(Rt,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const an=e=>`- ${e}`,ji=e=>h.isFunction(e)||e===null||e===!1,cn={getAdapter:e=>{e=h.isArray(e)?e:[e];const{length:t}=e;let o,n;const r={};for(let s=0;s<t;s++){o=e[s];let i;if(n=o,!ji(o)&&(n=Rt[(i=String(o)).toLowerCase()],n===void 0))throw new E(`Unknown adapter '${i}'`);if(n)break;r[i||"#"+s]=n}if(!n){const s=Object.entries(r).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=t?s.length>1?`since :
`+s.map(an).join(`
`):" "+an(s[0]):"as no adapter specified";throw new E("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:Rt};function Ot(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new we(null,e)}function ln(e){return Ot(e),e.headers=j.from(e.headers),e.data=Pt.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),cn.getAdapter(e.adapter||Oe.adapter)(e).then(function(n){return Ot(e),n.data=Pt.call(e,e.transformResponse,n),n.headers=j.from(n.headers),n},function(n){return Qo(n)||(Ot(e),n&&n.response&&(n.response.data=Pt.call(e,e.transformResponse,n.response),n.response.headers=j.from(n.response.headers))),Promise.reject(n)})}const dn="1.7.7",Mt={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Mt[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const un={};Mt.transitional=function(t,o,n){function r(s,i){return"[Axios v"+dn+"] Transitional option '"+s+"'"+i+(n?". "+n:"")}return(s,i,a)=>{if(t===!1)throw new E(r(i," has been removed"+(o?" in "+o:"")),E.ERR_DEPRECATED);return o&&!un[i]&&(un[i]=!0,console.warn(r(i," has been deprecated since v"+o+" and will be removed in the near future"))),t?t(s,i,a):!0}};function Vi(e,t,o){if(typeof e!="object")throw new E("options must be an object",E.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let r=n.length;for(;r-- >0;){const s=n[r],i=t[s];if(i){const a=e[s],c=a===void 0||i(a,s,e);if(c!==!0)throw new E("option "+s+" must be "+c,E.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new E("Unknown option "+s,E.ERR_BAD_OPTION)}}const Nt={assertOptions:Vi,validators:Mt},ae=Nt.validators;class ge{constructor(t){this.defaults=t,this.interceptors={request:new Ko,response:new Ko}}async request(t,o){try{return await this._request(t,o)}catch(n){if(n instanceof Error){let r;Error.captureStackTrace?Error.captureStackTrace(r={}):r=new Error;const s=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,o){typeof t=="string"?(o=o||{},o.url=t):o=t||{},o=me(this.defaults,o);const{transitional:n,paramsSerializer:r,headers:s}=o;n!==void 0&&Nt.assertOptions(n,{silentJSONParsing:ae.transitional(ae.boolean),forcedJSONParsing:ae.transitional(ae.boolean),clarifyTimeoutError:ae.transitional(ae.boolean)},!1),r!=null&&(h.isFunction(r)?o.paramsSerializer={serialize:r}:Nt.assertOptions(r,{encode:ae.function,serialize:ae.function},!0)),o.method=(o.method||this.defaults.method||"get").toLowerCase();let i=s&&h.merge(s.common,s[o.method]);s&&h.forEach(["delete","get","head","post","put","patch","common"],u=>{delete s[u]}),o.headers=j.concat(i,s);const a=[];let c=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(o)===!1||(c=c&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const l=[];this.interceptors.response.forEach(function(m){l.push(m.fulfilled,m.rejected)});let d,f=0,p;if(!c){const u=[ln.bind(this),void 0];for(u.unshift.apply(u,a),u.push.apply(u,l),p=u.length,d=Promise.resolve(o);f<p;)d=d.then(u[f++],u[f++]);return d}p=a.length;let w=o;for(f=0;f<p;){const u=a[f++],m=a[f++];try{w=u(w)}catch(g){m.call(this,g);break}}try{d=ln.call(this,w)}catch(u){return Promise.reject(u)}for(f=0,p=l.length;f<p;)d=d.then(l[f++],l[f++]);return d}getUri(t){t=me(this.defaults,t);const o=Yo(t.baseURL,t.url);return Ho(o,t.params,t.paramsSerializer)}}h.forEach(["delete","get","head","options"],function(t){ge.prototype[t]=function(o,n){return this.request(me(n||{},{method:t,url:o,data:(n||{}).data}))}}),h.forEach(["post","put","patch"],function(t){function o(n){return function(s,i,a){return this.request(me(a||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}ge.prototype[t]=o(),ge.prototype[t+"Form"]=o(!0)});class xt{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(s){o=s});const n=this;this.promise.then(r=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](r);n._listeners=null}),this.promise.then=r=>{let s;const i=new Promise(a=>{n.subscribe(a),s=a}).then(r);return i.cancel=function(){n.unsubscribe(s)},i},t(function(s,i,a){n.reason||(n.reason=new we(s,i,a),o(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const o=this._listeners.indexOf(t);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const t=new AbortController,o=n=>{t.abort(n)};return this.subscribe(o),t.signal.unsubscribe=()=>this.unsubscribe(o),t.signal}static source(){let t;return{token:new xt(function(r){t=r}),cancel:t}}}function Hi(e){return function(o){return e.apply(null,o)}}function Ki(e){return h.isObject(e)&&e.isAxiosError===!0}const Bt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Bt).forEach(([e,t])=>{Bt[t]=e});function hn(e){const t=new ge(e),o=Ao(ge.prototype.request,t);return h.extend(o,ge.prototype,t,{allOwnKeys:!0}),h.extend(o,t,null,{allOwnKeys:!0}),o.create=function(r){return hn(me(e,r))},o}const R=hn(Oe);R.Axios=ge,R.CanceledError=we,R.CancelToken=xt,R.isCancel=Qo,R.VERSION=dn,R.toFormData=Ke,R.AxiosError=E,R.Cancel=R.CanceledError,R.all=function(t){return Promise.all(t)},R.spread=Hi,R.isAxiosError=Ki,R.mergeConfig=me,R.AxiosHeaders=j,R.formToJSON=e=>zo(h.isHTMLForm(e)?new FormData(e):e),R.getAdapter=cn.getAdapter,R.HttpStatusCode=Bt,R.default=R;const Wi={components:{BaseChessBoard:Ue},extends:Ue,methods:{async handleMove(){var o,n;const e=(o=this.$refs.baseChessBoard.boardAPI)==null?void 0:o.getHistory(!0),t=e==null?void 0:e.map(r=>typeof r=="object"?r.lan:r);if(t)try{const r=this.$refs.baseChessBoard.boardAPI.getFen(),s=r.split(" ")[1]==="b";if((n=this.$refs.baseChessBoard.engine)==null||n.sendPosition(t.join(" ")),s){this.$refs.baseChessBoard.startBlackTimer();const a=(await R.post("http://localhost:3000/move",{move:{lan:t[t.length-1],after:r}})).data.bestMove;a&&this.$refs.baseChessBoard.boardAPI.move({from:a.slice(0,2),to:a.slice(2,4)})}else this.$refs.baseChessBoard.startWhiteTimer()}catch(r){console.error("Error sending move to server:",r)}}}};function zi(e,t,o,n,r,s){const i=b.resolveComponent("BaseChessBoard");return b.openBlock(),b.createBlock(i,{ref:"baseChessBoard",handleMove:s.handleMove},null,8,["handleMove"])}const fn=Fe(Wi,[["render",zi]]),Gi={components:{BaseChessBoard:Ue},extends:Ue,methods:{handleMove(){var r,s;const e=(r=this.$refs.baseChessBoard.boardAPI)==null?void 0:r.getHistory(!0),t=e==null?void 0:e.map(i=>typeof i=="object"?i.lan:i);this.$refs.baseChessBoard.boardAPI.getFen().split(" ")[1]==="b"?this.$refs.baseChessBoard.startBlackTimer():this.$refs.baseChessBoard.startWhiteTimer(),t&&((s=this.$refs.baseChessBoard.engine)==null||s.sendPosition(t.join(" ")))}}};function Qi(e,t,o,n,r,s){const i=b.resolveComponent("BaseChessBoard");return b.openBlock(),b.createBlock(i,{ref:"baseChessBoard",handleMove:s.handleMove},null,8,["handleMove"])}const pn=Fe(Gi,[["render",Qi]]),Ji={install(e){e.component(fn),e.component(pn)}};I.ChessBoard=fn,I.ChessBoardServerless=pn,I.default=Ji,Object.defineProperties(I,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
